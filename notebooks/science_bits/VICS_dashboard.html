

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Visualizing multivariate, spatio-temporal information in the Cloud with widgets &#8212; LMR-CMIP6 Paleobook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/science_bits/VICS_dashboard';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="PaMoDaCo: CMIP6 vs LMR" href="CMIP6_LMR.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    LMR-CMIP6 Paleobook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lifehacks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../lifehacks/data_from_esm_cloudcat.html">Accessing CMIP6 output with <code class="docutils literal notranslate"><span class="pre">intake</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../lifehacks/spatial_snapshots_xarray_bonuses.html">Leveraging <code class="docutils literal notranslate"><span class="pre">Xarray</span></code> for spatiotemporal diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lifehacks/widget_primer.html">A short introduction to widgets</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Science Bits</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="CMIP6_LMR.html">PaMoDaCo: CMIP6 vs LMR</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Visualizing multivariate, spatio-temporal information in the Cloud with widgets</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/LinkedEarth/LMR_CMIP_paleobook/main?urlpath=lab/tree/docs/notebooks/science_bits/VICS_dashboard.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/LinkedEarth/LMR_CMIP_paleobook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/LinkedEarth/LMR_CMIP_paleobook/issues/new?title=Issue%20on%20page%20%2Fnotebooks/science_bits/VICS_dashboard.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/science_bits/VICS_dashboard.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Visualizing multivariate, spatio-temporal information in the Cloud with widgets</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optical-properties-of-volcanic-aerosols">Optical properties of volcanic aerosols</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hovmuller-diagram-pcolor-plot">Hovmüller diagram:<code class="docutils literal notranslate"><span class="pre">pcolor</span></code> plot</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#components">Components</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#global-average-saod550-variation-timeseries">Global average SAOD550 variation timeseries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#weighted-mean">Weighted Mean</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-last-millennium-reanalysis-project-lmr">The Last Millennium Reanalysis Project (LMR)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dashboard">Dashboard</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-exhaustive-list-of-volcanic-events">Non-exhaustive list of volcanic events</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precompute-anomalies">Precompute anomalies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-the-dashboard">Building the dashboard</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-widget-control-to-the-dashboard">Adding widget control to the dashboard</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resources-and-references">Resources and references</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="visualizing-multivariate-spatio-temporal-information-in-the-cloud-with-widgets">
<h1>Visualizing multivariate, spatio-temporal information in the Cloud with widgets<a class="headerlink" href="#visualizing-multivariate-spatio-temporal-information-in-the-cloud-with-widgets" title="Permalink to this heading">#</a></h1>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>A common need of geoscientists is to diagnose their favorite system’s behavior in space and time across multiple variables. An example is the response of the climate system to explosive volcanism, which cools climate in the years that follow a large eruption. Effects can reverberate for several years across multiple variables, and building tools to visually track this information can be daunting. Inspired by the <a class="reference external" href="https://pastglobalchanges.org/science/wg/vics/intro">VICS working group</a>, this notebook shows how to build widgets that allow to probe the relationship between volcanism and climate over the Common Era.  This notebook shows how to:</p>
<ol class="arabic simple">
<li><p>Plot Hovmuller diagram of SAOD</p></li>
<li><p>Plot timeseries of global average SAOD550</p></li>
<li><p>Composing a dashboard</p></li>
<li><p>Making a dashboard navigable with widgets</p></li>
</ol>
<ul class="simple">
<li><p><strong>Time to learn</strong>: 20 min</p></li>
</ul>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Concepts</p></th>
<th class="head"><p>Importance</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/cartopy/cartopy.html">Intro to Cartopy</a></p></td>
<td><p>Necessary</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/data-formats/netcdf-cf.html">Understanding of NetCDF</a></p></td>
<td><p>Helpful</p></td>
<td><p>Familiarity with metadata structure</p></td>
</tr>
</tbody>
</table>
</section>
<hr class="docutils" />
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cftime</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>

<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">import</span> <span class="nn">cartopy.util</span> <span class="k">as</span> <span class="nn">cutil</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="optical-properties-of-volcanic-aerosols">
<h2>Optical properties of volcanic aerosols<a class="headerlink" href="#optical-properties-of-volcanic-aerosols" title="Permalink to this heading">#</a></h2>
<p>Here we will use the eVolv2k EVA AOD data [Toohey and Sigl, 2017]. These data have dimensions of latitude (degrees north) and time (fractional years), which warrants investigation in continuous space, but also we will eventually want to convert to a global yearly average. Excellent! A teachable moment awaits! First, we’ll load some data using Xarray.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_data</span> <span class="o">=</span> <span class="s1">&#39;eVolv2k_v3_EVA_AOD_-500_1900_1.nc&#39;</span>
<span class="n">vol_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">/</span><span class="s1">&#39;data&#39;</span><span class="o">/</span><span class="n">vol_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_ds</span> <span class="o">=</span> <span class="n">vol_ds</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">lat_rad</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">vol_ds</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
<span class="n">vol_ds</span> <span class="o">=</span> <span class="n">vol_ds</span><span class="o">.</span><span class="n">set_coords</span><span class="p">([</span><span class="s1">&#39;lat_rad&#39;</span><span class="p">])</span>
<span class="n">vol_ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:  (time: 28812, lat: 96)
Coordinates:
  * time     (time) float32 -500.0 -499.9 -499.8 ... 1.901e+03 1.901e+03
  * lat      (lat) float32 88.57 86.72 84.86 83.0 ... -83.0 -84.86 -86.72 -88.57
    lat_rad  (lat) float32 1.546 1.514 1.481 1.449 ... -1.481 -1.514 -1.546
Data variables:
    aod550   (time, lat) float32 ...
    reff     (time, lat) float32 ...
Attributes:
    title:                         EVA v1.2: stratospheric AOD
    EVA_reference:                 Toohey, M., Stevens, B., Schmidt, H., and ...
    EVA_source_code:               https://github.com/matthew2e/easy-volcanic...
    input_vssi_file:               eVolv2k_v3_ds_1.nc
    input_sulfate_parameter_file:  EVAv1_parameter_set_piBG.nc
    input_forcing_parameter_file:  EVAv1_parameter_set_piBG.nc
    input_grid_file:               eva_gridfile_echam_T63_sw.nc
    input_Mie_file:                eva_Mie_lookuptables.nc
    history:                       Created on 15.07.2019 at 14:29:58</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-1f04099b-9759-4eed-b266-164139afb5e2' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1f04099b-9759-4eed-b266-164139afb5e2' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 28812</li><li><span class='xr-has-index'>lat</span>: 96</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-77701954-5d6c-4e65-8e1b-3a841d882dbb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-77701954-5d6c-4e65-8e1b-3a841d882dbb' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-500.0 -499.9 ... 1.901e+03</div><input id='attrs-7f679f66-1a58-4df8-94ed-309ed65850d6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7f679f66-1a58-4df8-94ed-309ed65850d6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0bff3809-a051-41b8-ad18-a9ac860ee2fd' class='xr-var-data-in' type='checkbox'><label for='data-0bff3809-a051-41b8-ad18-a9ac860ee2fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>fractional year (ISO 8601, including year 0)</dd><dt><span>units :</span></dt><dd>year</dd></dl></div><div class='xr-var-data'><pre>array([-500.     , -499.91666, -499.83334, ..., 1900.75   , 1900.8334 ,
       1900.9166 ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>88.57 86.72 84.86 ... -86.72 -88.57</div><input id='attrs-89ad52d0-7a97-41cb-86b0-78c4aa6eaf92' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-89ad52d0-7a97-41cb-86b0-78c4aa6eaf92' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9f4107d5-28da-420d-9e14-6b655acfe100' class='xr-var-data-in' type='checkbox'><label for='data-9f4107d5-28da-420d-9e14-6b655acfe100' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees north</dd></dl></div><div class='xr-var-data'><pre>array([ 88.57217 ,  86.722534,  84.86197 ,  82.99894 ,  81.13498 ,  79.27056 ,
        77.40589 ,  75.54106 ,  73.67613 ,  71.811134,  69.94608 ,  68.08099 ,
        66.21587 ,  64.35073 ,  62.485573,  60.620396,  58.75521 ,  56.890015,
        55.024807,  53.159595,  51.294376,  49.429153,  47.563927,  45.698692,
        43.833458,  41.96822 ,  40.102978,  38.237736,  36.37249 ,  34.507244,
        32.641994,  30.776745,  28.911491,  27.04624 ,  25.180986,  23.315731,
        21.450476,  19.585218,  17.719961,  15.854704,  13.989446,  12.124187,
        10.258928,   8.393669,   6.528409,   4.66315 ,   2.79789 ,   0.93263 ,
        -0.93263 ,  -2.79789 ,  -4.66315 ,  -6.528409,  -8.393669, -10.258928,
       -12.124187, -13.989446, -15.854704, -17.719961, -19.585218, -21.450476,
       -23.315731, -25.180986, -27.04624 , -28.911491, -30.776745, -32.641994,
       -34.507244, -36.37249 , -38.237736, -40.102978, -41.96822 , -43.833458,
       -45.698692, -47.563927, -49.429153, -51.294376, -53.159595, -55.024807,
       -56.890015, -58.75521 , -60.620396, -62.485573, -64.35073 , -66.21587 ,
       -68.08099 , -69.94608 , -71.811134, -73.67613 , -75.54106 , -77.40589 ,
       -79.27056 , -81.13498 , -82.99894 , -84.86197 , -86.722534, -88.57217 ],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat_rad</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.546 1.514 1.481 ... -1.514 -1.546</div><input id='attrs-e53a4eb9-e709-4d76-a4bd-c830dc4f31d6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e53a4eb9-e709-4d76-a4bd-c830dc4f31d6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5670e237-950b-40b2-b09a-476e730621f4' class='xr-var-data-in' type='checkbox'><label for='data-5670e237-950b-40b2-b09a-476e730621f4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees north</dd></dl></div><div class='xr-var-data'><pre>array([ 1.5458759 ,  1.5135938 ,  1.4811207 ,  1.4486047 ,  1.4160725 ,
        1.3835323 ,  1.3509877 ,  1.3184402 ,  1.285891  ,  1.2533407 ,
        1.2207894 ,  1.1882374 ,  1.155685  ,  1.1231321 ,  1.0905789 ,
        1.0580255 ,  1.0254719 ,  0.9929181 ,  0.96036404,  0.92780995,
        0.89525574,  0.8627015 ,  0.83014715,  0.79759264,  0.76503813,
        0.7324836 ,  0.699929  ,  0.6673744 ,  0.6348197 ,  0.602265  ,
        0.56971025,  0.5371555 ,  0.5046007 ,  0.47204593,  0.43949112,
        0.40693626,  0.37438142,  0.34182656,  0.30927166,  0.27671677,
        0.24416189,  0.211607  ,  0.17905207,  0.14649716,  0.11394224,
        0.08138732,  0.04883239,  0.01627746, -0.01627746, -0.04883239,
       -0.08138732, -0.11394224, -0.14649716, -0.17905207, -0.211607  ,
       -0.24416189, -0.27671677, -0.30927166, -0.34182656, -0.37438142,
       -0.40693626, -0.43949112, -0.47204593, -0.5046007 , -0.5371555 ,
       -0.56971025, -0.602265  , -0.6348197 , -0.6673744 , -0.699929  ,
       -0.7324836 , -0.76503813, -0.79759264, -0.83014715, -0.8627015 ,
       -0.89525574, -0.92780995, -0.96036404, -0.9929181 , -1.0254719 ,
       -1.0580255 , -1.0905789 , -1.1231321 , -1.155685  , -1.1882374 ,
       -1.2207894 , -1.2533407 , -1.285891  , -1.3184402 , -1.3509877 ,
       -1.3835323 , -1.4160725 , -1.4486047 , -1.4811207 , -1.5135938 ,
       -1.5458759 ], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9279ecd6-17ee-49c3-bedb-466d2784f562' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9279ecd6-17ee-49c3-bedb-466d2784f562' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>aod550</span></div><div class='xr-var-dims'>(time, lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-770b88ef-21d7-4ccc-b82c-c5029b89f57a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-770b88ef-21d7-4ccc-b82c-c5029b89f57a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6e836ca7-9d7f-4d0f-adcc-8a0ee3fd7a0b' class='xr-var-data-in' type='checkbox'><label for='data-6e836ca7-9d7f-4d0f-adcc-8a0ee3fd7a0b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>aerosol optical depth</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>[2765952 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>reff</span></div><div class='xr-var-dims'>(time, lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-70eaa18f-2e79-43ea-b03e-b603256a0ac9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-70eaa18f-2e79-43ea-b03e-b603256a0ac9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e22d03d6-0b15-45de-895e-fba19d285040' class='xr-var-data-in' type='checkbox'><label for='data-e22d03d6-0b15-45de-895e-fba19d285040' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>aerosol effective radius</dd><dt><span>units :</span></dt><dd>mu m</dd></dl></div><div class='xr-var-data'><pre>[2765952 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-346e313c-1b18-48ef-b0a2-f4da7ba4b496' class='xr-section-summary-in' type='checkbox'  ><label for='section-346e313c-1b18-48ef-b0a2-f4da7ba4b496' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-916e17b7-d549-4c09-b379-a582fff3922d' class='xr-index-data-in' type='checkbox'/><label for='index-916e17b7-d549-4c09-b379-a582fff3922d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([            -500.0, -499.9166564941406, -499.8333435058594,
                         -499.75, -499.6666564941406, -499.5833435058594,
                          -499.5, -499.4166564941406, -499.3333435058594,
                         -499.25,
              ...
              1900.1666259765625,            1900.25, 1900.3333740234375,
              1900.4166259765625,             1900.5, 1900.5833740234375,
              1900.6666259765625,            1900.75, 1900.8333740234375,
              1900.9166259765625],
             dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=28812))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6d06426d-2cb4-40f7-8ed6-15e3f21668b0' class='xr-index-data-in' type='checkbox'/><label for='index-6d06426d-2cb4-40f7-8ed6-15e3f21668b0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([   88.5721664428711,    86.7225341796875,   84.86196899414062,
                82.99893951416016,   81.13497924804688,   79.27056121826172,
                77.40589141845703,   75.54106140136719,   73.67613220214844,
                 71.8111343383789,   69.94608306884766,   68.08099365234375,
                66.21587371826172,    64.3507308959961,  62.485572814941406,
                60.62039566040039,  58.755210876464844,    56.8900146484375,
                55.02480697631836,   53.15959548950195,  51.294376373291016,
                49.42915344238281,  47.563926696777344,  45.698692321777344,
               43.833457946777344,   41.96821975708008,   40.10297775268555,
               38.237735748291016,   36.37248992919922,   34.50724411010742,
                32.64199447631836,  30.776744842529297,   28.91149139404297,
               27.046239852905273,  25.180986404418945,  23.315731048583984,
               21.450475692749023,   19.58521842956543,  17.719961166381836,
               15.854703903198242,  13.989445686340332,  12.124187469482422,
               10.258928298950195,   8.393669128417969,   6.528409481048584,
                4.663149833679199,  2.7978899478912354,  0.9326299428939819,
              -0.9326299428939819, -2.7978899478912354,  -4.663149833679199,
               -6.528409481048584,  -8.393669128417969, -10.258928298950195,
              -12.124187469482422, -13.989445686340332, -15.854703903198242,
              -17.719961166381836,  -19.58521842956543, -21.450475692749023,
              -23.315731048583984, -25.180986404418945, -27.046239852905273,
               -28.91149139404297, -30.776744842529297,  -32.64199447631836,
               -34.50724411010742,  -36.37248992919922, -38.237735748291016,
               -40.10297775268555,  -41.96821975708008, -43.833457946777344,
              -45.698692321777344, -47.563926696777344,  -49.42915344238281,
              -51.294376373291016,  -53.15959548950195,  -55.02480697631836,
                -56.8900146484375, -58.755210876464844,  -60.62039566040039,
              -62.485572814941406,   -64.3507308959961,  -66.21587371826172,
               -68.08099365234375,  -69.94608306884766,   -71.8111343383789,
               -73.67613220214844,  -75.54106140136719,  -77.40589141845703,
               -79.27056121826172,  -81.13497924804688,  -82.99893951416016,
               -84.86196899414062,   -86.7225341796875,   -88.5721664428711],
             dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7cc08089-ff5c-449d-a987-329201ff1715' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7cc08089-ff5c-449d-a987-329201ff1715' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>EVA v1.2: stratospheric AOD</dd><dt><span>EVA_reference :</span></dt><dd>Toohey, M., Stevens, B., Schmidt, H., and Timmreck,C.: Easy Volcanic Aerosol (EVA v1.0): an idealized forcing generator for climate simulations, Geosci. Model Dev., 9, 4049-4070, https://doi.org/10.5194/gmd-9-4049-2016, 2016.</dd><dt><span>EVA_source_code :</span></dt><dd>https://github.com/matthew2e/easy-volcanic-aerosol</dd><dt><span>input_vssi_file :</span></dt><dd>eVolv2k_v3_ds_1.nc</dd><dt><span>input_sulfate_parameter_file :</span></dt><dd>EVAv1_parameter_set_piBG.nc</dd><dt><span>input_forcing_parameter_file :</span></dt><dd>EVAv1_parameter_set_piBG.nc</dd><dt><span>input_grid_file :</span></dt><dd>eva_gridfile_echam_T63_sw.nc</dd><dt><span>input_Mie_file :</span></dt><dd>eva_Mie_lookuptables.nc</dd><dt><span>history :</span></dt><dd>Created on 15.07.2019 at 14:29:58</dd></dl></div></li></ul></div></div></div></div>
</div>
<section id="hovmuller-diagram-pcolor-plot">
<h3>Hovmüller diagram:<code class="docutils literal notranslate"><span class="pre">pcolor</span></code> plot<a class="headerlink" href="#hovmuller-diagram-pcolor-plot" title="Permalink to this heading">#</a></h3>
<p>We don’t have latitude-longitude pairs for <code class="docutils literal notranslate"><span class="pre">aod550</span></code> data, but given atmospheric mixing across latitude bands, it may be informative to plot variation in the stratospheric aerosol optical depth (SAOD) at a wavelength of 550 nm on a time-latitude grid.</p>
<section id="components">
<h4>Components<a class="headerlink" href="#components" title="Permalink to this heading">#</a></h4>
<p>This plot depends on figure, so we’ll want to apply our colorbar approach from the prior plots, from the get-go. Thus, we need:</p>
<ul class="simple">
<li><p>figure + gridspec (with slots for the figure and colorbar)</p></li>
<li><p>a scalar mappable (generated with <code class="docutils literal notranslate"><span class="pre">make_scalar_mappable()</span></code>)</p></li>
<li><p>meshgrid</p></li>
<li><p>pcolor</p></li>
</ul>
<p>Somewhat similarly to how we constructed an appropriate coordinate system for the filled contour plots using the cyclic_point, we can pass two vectors to <code class="docutils literal notranslate"><span class="pre">np.meshgrid()</span></code> to create the components of grid that underpins our <code class="docutils literal notranslate"><span class="pre">pcolor</span></code> plot. Then, also like the filled contour plots, all we need to do is pass the grid components, a matrix of values, and information about the color scheme to <code class="docutils literal notranslate"><span class="pre">ax.pcolor()</span></code>, and we’ll be on our way!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># consider a window around a year of interest</span>
<span class="n">before</span><span class="p">,</span> <span class="n">after</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">erup_yr</span><span class="o">=</span><span class="mi">940</span>

<span class="n">itmp_slice</span> <span class="o">=</span> <span class="n">vol_ds</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="nb">slice</span><span class="p">(</span><span class="n">erup_yr</span><span class="o">-</span><span class="n">before</span><span class="p">,</span> <span class="n">erup_yr</span><span class="o">+</span><span class="n">after</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<p>If we wanted the coloring to be scaled to the data in this specific interval, we could use local minimum and maximum values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_scalar_mappable</span><span class="p">(</span><span class="n">lims</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">ax_norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">lims</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">lims</span><span class="p">),</span> <span class="n">clip</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax_cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>    
        <span class="n">ax_cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">ax_sm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">ax_norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">ax_cmap</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax_sm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># interval specific color scale</span>
<span class="n">vol_vlims</span> <span class="o">=</span> <span class="p">[</span><span class="n">itmp_slice</span><span class="o">.</span><span class="n">aod550</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">itmp_slice</span><span class="o">.</span><span class="n">aod550</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">ax0_sm</span> <span class="o">=</span> <span class="n">make_scalar_mappable</span><span class="p">(</span><span class="n">vol_vlims</span><span class="p">,</span> <span class="s1">&#39;magma&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>However, If we wanted this figure to maintain the same colorscale regardless of the <code class="docutils literal notranslate"><span class="pre">erup_yr</span></code>, we could use the minimum and maximum values of all the SAOD variation data to calculate our <code class="docutils literal notranslate"><span class="pre">scalar_mappable</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># general color scale</span>
<span class="n">vol_vlims</span> <span class="o">=</span> <span class="p">[</span><span class="n">vol_ds</span><span class="o">.</span><span class="n">aod550</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vol_ds</span><span class="o">.</span><span class="n">aod550</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">ax0_sm</span> <span class="o">=</span> <span class="n">make_scalar_mappable</span><span class="p">(</span><span class="n">vol_vlims</span><span class="p">,</span> <span class="s1">&#39;magma&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we’ll use <code class="docutils literal notranslate"><span class="pre">np.meshgrid()</span></code> to construct a time-latitude (in radians) grid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">itmp_slice</span><span class="o">.</span><span class="n">time</span><span class="p">,</span><span class="n">itmp_slice</span><span class="o">.</span><span class="n">lat_rad</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="c1"># 2 rows, 1 column, .05 space between rows, 8:.3 ratio of top row to bottom row</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mf">.3</span><span class="p">])</span>
    
<span class="c1"># evolv2k AOD</span>
<span class="n">ax0</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">pc</span> <span class="o">=</span> <span class="n">ax0</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span><span class="n">itmp_slice</span><span class="o">.</span><span class="n">aod550</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">ax0_sm</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">ax0_sm</span><span class="o">.</span><span class="n">norm</span><span class="p">)</span>
<span class="c1"># write ticks in degrees</span>
<span class="n">tick_deg</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">tick</span><span class="p">))</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax0</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()]</span>
<span class="n">ax0_axformatting_d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ylabel&#39;</span><span class="p">:</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> 
                      <span class="s1">&#39;yticklabels&#39;</span><span class="p">:</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">tick_deg</span><span class="p">),</span> 
                    <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span><span class="s1">&#39;Year&#39;</span><span class="p">}</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="n">ax0_axformatting_d</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;evolv2k AOD&#39;</span><span class="p">)</span>

<span class="c1"># colorbar</span>
<span class="n">ax0c</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax0_cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax0_sm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">ax0c</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/8f/31mjs7t50z73h7x1sf90w8040000gn/T/ipykernel_32614/3920750907.py:13: UserWarning: FixedFormatter should only be used together with FixedLocator
  ax0.set(**ax0_axformatting_d)
</pre></div>
</div>
<img alt="../../_images/9c7ab2515eabb6abb6c8294fbec136fdd0f3e9bc08e27e45e4699c3df09f5f71.png" src="../../_images/9c7ab2515eabb6abb6c8294fbec136fdd0f3e9bc08e27e45e4699c3df09f5f71.png" />
</div>
</div>
</section>
</section>
<section id="global-average-saod550-variation-timeseries">
<h3>Global average SAOD550 variation timeseries<a class="headerlink" href="#global-average-saod550-variation-timeseries" title="Permalink to this heading">#</a></h3>
<p>In conjunction with a pcolor plot, it can be useful to look at the evolution of a summary statistic like the global mean. The <code class="docutils literal notranslate"><span class="pre">time</span></code> dimension of this dataset is different from that in the LMR data. The attributes say that it is in “fractional year (ISO 8601, including year 0)”, which, with a little inspection, we see means that there are 12 values per year (monthly) reported at the beginning of each month. Our goal is to bring this data onto the same timescale as the LMR data (yearly), and the easiest way to do this will be to group by year, and take the mean.</p>
<p><em>Side note: The study of history goes from 1BCE to 1CE without hesitation, but this poses some challenges mathematically with timeseries. Thus, we’ll stick to the standard astronomical calendar, which stricks a year 0 in between.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_ds</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;time&#x27; (time: 28812)&gt;
array([-500.     , -499.91666, -499.83334, ..., 1900.75   , 1900.8334 ,
       1900.9166 ], dtype=float32)
Coordinates:
  * time     (time) float32 -500.0 -499.9 -499.8 ... 1.901e+03 1.901e+03
Attributes:
    long_name:  fractional year (ISO 8601, including year 0)
    units:      year</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'time'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 28812</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-f49b7892-ce6f-440d-b08f-7d4a03bec1fd' class='xr-array-in' type='checkbox' checked><label for='section-f49b7892-ce6f-440d-b08f-7d4a03bec1fd' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-500.0 -499.9 -499.8 -499.8 ... 1.901e+03 1.901e+03 1.901e+03</span></div><div class='xr-array-data'><pre>array([-500.     , -499.91666, -499.83334, ..., 1900.75   , 1900.8334 ,
       1900.9166 ], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-f02ec16d-eb2b-4cc0-858c-5b21b393bb78' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f02ec16d-eb2b-4cc0-858c-5b21b393bb78' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-500.0 -499.9 ... 1.901e+03</div><input id='attrs-2e42270a-cf86-41dc-8166-7c55d85d783e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2e42270a-cf86-41dc-8166-7c55d85d783e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-18726028-1a99-4e8c-a08f-40f8e81816a5' class='xr-var-data-in' type='checkbox'><label for='data-18726028-1a99-4e8c-a08f-40f8e81816a5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>fractional year (ISO 8601, including year 0)</dd><dt><span>units :</span></dt><dd>year</dd></dl></div><div class='xr-var-data'><pre>array([-500.     , -499.91666, -499.83334, ..., 1900.75   , 1900.8334 ,
       1900.9166 ], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3b608c97-eef2-4fc6-a936-c0e5c2c7e69d' class='xr-section-summary-in' type='checkbox'  ><label for='section-3b608c97-eef2-4fc6-a936-c0e5c2c7e69d' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1a9b060c-97ef-4210-8542-3ed474d78bc7' class='xr-index-data-in' type='checkbox'/><label for='index-1a9b060c-97ef-4210-8542-3ed474d78bc7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([            -500.0, -499.9166564941406, -499.8333435058594,
                         -499.75, -499.6666564941406, -499.5833435058594,
                          -499.5, -499.4166564941406, -499.3333435058594,
                         -499.25,
              ...
              1900.1666259765625,            1900.25, 1900.3333740234375,
              1900.4166259765625,             1900.5, 1900.5833740234375,
              1900.6666259765625,            1900.75, 1900.8333740234375,
              1900.9166259765625],
             dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=28812))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-16cb9394-8aae-4ab8-9f80-16069cf04f0b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-16cb9394-8aae-4ab8-9f80-16069cf04f0b' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>fractional year (ISO 8601, including year 0)</dd><dt><span>units :</span></dt><dd>year</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_ds</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;time&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vol_ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="weighted-mean">
<h3>Weighted Mean<a class="headerlink" href="#weighted-mean" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_ds_weighted</span> <span class="o">=</span> <span class="n">vol_ds</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lat_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">vol_ds_weighted</span><span class="o">.</span><span class="n">lat_rad</span><span class="p">)</span>
<span class="n">lat_weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;lat_weights&quot;</span>

<span class="n">vol_ds_weighted</span><span class="p">[</span><span class="s1">&#39;weighted_aod550&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="p">(</span><span class="n">vol_ds_weighted</span><span class="p">[</span><span class="s1">&#39;aod550&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">lat_weights</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">vol_ds_weighted</span> <span class="o">=</span> <span class="n">vol_ds_weighted</span><span class="o">.</span><span class="n">set_coords</span><span class="p">([</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We can finally use <code class="docutils literal notranslate"><span class="pre">groupby('year').mean().mean(dim='lat')</span></code> to first calculate the weights-applied latitude-wise yearly average, and then calculate the global yearly average.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_ds_year_wm</span> <span class="o">=</span> <span class="n">vol_ds_weighted</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
<span class="n">vol_ds_year_wm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:          (year: 2400)
Coordinates:
  * year             (year) int64 -499 -498 -497 -496 ... 1897 1898 1899 1900
Data variables:
    aod550           (year) float32 0.002833 0.002861 ... 0.002903 0.002903
    reff             (year) float32 0.2 0.2 0.2 0.2 0.2 ... 0.2 0.2 0.2 0.2 0.2
    weighted_aod550  (year) float32 0.001826 0.001836 ... 0.001863 0.001863</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-69fce122-37be-410f-96cf-60c8d01b7347' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-69fce122-37be-410f-96cf-60c8d01b7347' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 2400</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-55b2cc87-eaaf-413e-bbc8-d7ed9782325e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-55b2cc87-eaaf-413e-bbc8-d7ed9782325e' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>-499 -498 -497 ... 1898 1899 1900</div><input id='attrs-3c8f8b7a-ffc0-44e4-862c-bf48c23f9f0a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3c8f8b7a-ffc0-44e4-862c-bf48c23f9f0a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-627f98ab-3585-446f-bd32-f145641dd155' class='xr-var-data-in' type='checkbox'><label for='data-627f98ab-3585-446f-bd32-f145641dd155' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-499, -498, -497, ..., 1898, 1899, 1900])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3c914218-a90d-4a0c-b306-e07fd567cde1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3c914218-a90d-4a0c-b306-e07fd567cde1' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>aod550</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.002833 0.002861 ... 0.002903</div><input id='attrs-1d787b77-752c-4047-b907-8fd7ae28b584' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1d787b77-752c-4047-b907-8fd7ae28b584' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d48acea4-e047-4635-9a5d-5ecfbe9c37c6' class='xr-var-data-in' type='checkbox'><label for='data-d48acea4-e047-4635-9a5d-5ecfbe9c37c6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.00283285, 0.00286093, 0.00288803, ..., 0.00290414, 0.00290311,
       0.00290276], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>reff</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.2 0.2 0.2 0.2 ... 0.2 0.2 0.2 0.2</div><input id='attrs-101ced65-0acb-4714-bba8-5bf743a71aa4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-101ced65-0acb-4714-bba8-5bf743a71aa4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-96b556d6-b5dd-45a9-877a-e75a2734f9e0' class='xr-var-data-in' type='checkbox'><label for='data-96b556d6-b5dd-45a9-877a-e75a2734f9e0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.20000003, 0.20000003, 0.20000003, ..., 0.20000003, 0.20000003,
       0.20000003], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>weighted_aod550</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001826 0.001836 ... 0.001863</div><input id='attrs-9b4ec325-6670-49e8-82d8-ec74f1456364' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9b4ec325-6670-49e8-82d8-ec74f1456364' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-79304c62-45d8-491c-ad4c-69e6eefddd68' class='xr-var-data-in' type='checkbox'><label for='data-79304c62-45d8-491c-ad4c-69e6eefddd68' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.00182573, 0.00183631, 0.00185314, ..., 0.00186362, 0.00186294,
       0.00186272], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2c77d4be-8e5a-49a8-9d5b-b231979bafad' class='xr-section-summary-in' type='checkbox'  ><label for='section-2c77d4be-8e5a-49a8-9d5b-b231979bafad' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-25656b1b-3dca-4793-a0bb-78a1e5b2637c' class='xr-index-data-in' type='checkbox'/><label for='index-25656b1b-3dca-4793-a0bb-78a1e5b2637c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([-499, -498, -497, -496, -495, -494, -493, -492, -491, -490,
            ...
            1891, 1892, 1893, 1894, 1895, 1896, 1897, 1898, 1899, 1900],
           dtype=&#x27;int64&#x27;, name=&#x27;year&#x27;, length=2400))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-82de0511-9af2-49c6-891b-9c3a94937625' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-82de0511-9af2-49c6-891b-9c3a94937625' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Let’s put the <code class="docutils literal notranslate"><span class="pre">pcolor</span></code> plot above in a grid with the corresponding time segment of the global average timeseries. There are only two new plotting notes:</p>
<ol class="arabic simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">gridspec</span></code> has four slots to accommodate the pcolor plot and its colorbar, the timeseries, and an empty slot to act as a buffer between the colorbar and the timeseries</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ax1.sharex(ax0)</span></code> ensures that the two plots will share the same x-axis</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">itmp_slice_yr</span> <span class="o">=</span> <span class="n">vol_ds_year_wm</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">erup_yr</span><span class="p">)</span><span class="o">-</span><span class="n">before</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">erup_yr</span><span class="p">)</span><span class="o">+</span><span class="n">after</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>In the same category as applying latitude-based weights to calculate a more accurate global average, let’s revisit the spacing of the latitude axis of our SAOD (lat, time) Hovmüller diagram (our pcolor plot). By using sin(lat) as the y coordinate on a plot like this, the actual area of the globe covered by a given latitude band is preserved, allowing us to “integrate by eye” and better gauge the contribution of each latitude band to the total.</p>
<p>We’ll stow these new tick locations, and tick labels in degrees north, along with other axis information a dictionary to efficiently update the axes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tick_lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">sin_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">tick_lat</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>

<span class="n">ax0_axformatting_d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ylabel&#39;</span><span class="p">:</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> 
                       <span class="s1">&#39;ylim&#39;</span><span class="p">:[</span><span class="nb">min</span><span class="p">(</span><span class="n">sin_ticks</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">sin_ticks</span><span class="p">)],</span> 
                       <span class="s1">&#39;yticks&#39;</span><span class="p">:</span><span class="n">sin_ticks</span><span class="p">,</span> <span class="s1">&#39;yticklabels&#39;</span><span class="p">:</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">tick_lat</span><span class="p">)}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="c1"># 3 rows, 1 column, .15 space between rows, 8:.3 ratio of top row to bottom row</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="c1"># evolv2k AOD</span>
<span class="c1"># pcolor</span>
<span class="n">ax0</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">pc</span> <span class="o">=</span> <span class="n">ax0</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span><span class="n">itmp_slice</span><span class="o">.</span><span class="n">aod550</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">ax0_sm</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">ax0_sm</span><span class="o">.</span><span class="n">norm</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;evolv2k AOD&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="n">ax0_axformatting_d</span><span class="p">)</span>

<span class="c1"># colorbar</span>
<span class="n">ax0c</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax0_cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax0_sm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">ax0c</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>


<span class="c1"># timeseries</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">sharex</span><span class="p">(</span><span class="n">ax0</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">itmp_slice_yr</span><span class="o">.</span><span class="n">year</span><span class="p">,</span><span class="n">itmp_slice_yr</span><span class="o">.</span><span class="n">weighted_aod550</span><span class="p">,</span><span class="s1">&#39;-o&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;ylabel&#39;</span><span class="p">:</span><span class="s1">&#39;global AOD&#39;</span><span class="p">,</span> <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span><span class="s1">&#39;Year&#39;</span><span class="p">})</span>

<span class="n">ax0</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3c9d108c5d4734aff8e9b0e07c3ca80124ecba54d392f47b6ee0216719eadb7c.png" src="../../_images/3c9d108c5d4734aff8e9b0e07c3ca80124ecba54d392f47b6ee0216719eadb7c.png" />
</div>
</div>
</section>
</section>
<section id="the-last-millennium-reanalysis-project-lmr">
<h2>The Last Millennium Reanalysis Project (LMR)<a class="headerlink" href="#the-last-millennium-reanalysis-project-lmr" title="Permalink to this heading">#</a></h2>
<p>For a deeper discussion of LMR, check out our science bit about <a class="reference internal" href="CMIP6_LMR.html"><span class="doc std std-doc">CMIP6 and LMR</span></a>. The gridded output from the Last Millenium Reanalysis Project is (happily) available via Pangeo-Forge.</p>
<p>This LMR data set contains output for 20 Monte Carlo simulations (<code class="docutils literal notranslate"><span class="pre">MCrun</span></code>) run on a 2x2 degree latitude-longitude grid. Monte Carlo simulations are a useful way of acknowledging that we don’t know exactly how climate evolved, but the group characteristics of multiple possible trajectories are more likely to capture the underlying story.</p>
<p><em><strong><a class="reference external" href="https://pangeo-forge.org/">Pangeo-Forge</a></strong>:</em></p>
<p>Briefly, Pangeo-Forge is a project that makes it easy to access large datasets (often stored in many parts) via a url, and work with them without having to maintain local copies of the data–good for the hard drive, good for the RAM! For more information about Pangeo-Forge, the intrepid reader might appreciate their much more nuanced tutorials available <a class="reference external" href="https://github.com/pangeo-forge/pangeo-forge-recipes/tree/94e87d4ae687020527ac25cefec776bcff352834/docs/introduction_tutorial">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load data using Pangeo-Forge</span>
<span class="n">store</span> <span class="o">=</span> <span class="s2">&quot;https://ncsa.osn.xsede.org/Pangeo/pangeo-forge/test/pangeo-forge/staged-recipes/recipe-run-1200/LMRv2p1_MCruns_ensemble_gridded.zarr&quot;</span>
<span class="n">lmr_ds_gridded</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;zarr&#39;</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{})</span>
<span class="n">lmr_ds_gridded</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:        (time: 2001, MCrun: 20, lat: 91, lon: 180)
Coordinates:
  * lat            (lat) float32 -90.0 -88.0 -86.0 -84.0 ... 84.0 86.0 88.0 90.0
  * lon            (lon) float32 0.0 2.0 4.0 6.0 8.0 ... 352.0 354.0 356.0 358.0
  * time           (time) object 0000-01-01 00:00:00 ... 2000-01-01 00:00:00
Dimensions without coordinates: MCrun
Data variables: (12/14)
    air_mean       (time, MCrun, lat, lon) float32 dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;
    air_spread     (time, MCrun, lat, lon) float32 dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;
    hgt500_mean    (time, MCrun, lat, lon) float32 dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;
    hgt500_spread  (time, MCrun, lat, lon) float32 dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;
    pdsi_mean      (time, MCrun, lat, lon) float32 dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;
    pdsi_spread    (time, MCrun, lat, lon) float32 dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;
    ...             ...
    prate_mean     (time, MCrun, lat, lon) float32 dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;
    prate_spread   (time, MCrun, lat, lon) float32 dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;
    prmsl_mean     (time, MCrun, lat, lon) float32 dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;
    prmsl_spread   (time, MCrun, lat, lon) float32 dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;
    sst_mean       (time, MCrun, lat, lon) float32 dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;
    sst_spread     (time, MCrun, lat, lon) float32 dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;
Attributes:
    comment:      File contains ensemble spread values for each Monte-Carlo r...
    description:  Last Millennium Reanalysis climate field reconstruction for...
    experiment:   productionFinal2_gisgpcc_ccms4_LMRdbv1.1.0_z500</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e1a6047d-5c79-4be4-a375-32561c8e6b6d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e1a6047d-5c79-4be4-a375-32561c8e6b6d' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2001</li><li><span>MCrun</span>: 20</li><li><span class='xr-has-index'>lat</span>: 91</li><li><span class='xr-has-index'>lon</span>: 180</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b14c71a6-402e-48eb-9cb0-576849f8b7c6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b14c71a6-402e-48eb-9cb0-576849f8b7c6' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -88.0 -86.0 ... 88.0 90.0</div><input id='attrs-793ef5ae-b351-45b3-9427-dbe0237c8ca8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-793ef5ae-b351-45b3-9427-dbe0237c8ca8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e379f81c-f086-4284-a14b-a8d09cbcf758' class='xr-var-data-in' type='checkbox'><label for='data-e379f81c-f086-4284-a14b-a8d09cbcf758' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>actual_range :</span></dt><dd>[-90.0, 90.0]</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd><dt><span>description :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-90., -88., -86., -84., -82., -80., -78., -76., -74., -72., -70., -68.,
       -66., -64., -62., -60., -58., -56., -54., -52., -50., -48., -46., -44.,
       -42., -40., -38., -36., -34., -32., -30., -28., -26., -24., -22., -20.,
       -18., -16., -14., -12., -10.,  -8.,  -6.,  -4.,  -2.,   0.,   2.,   4.,
         6.,   8.,  10.,  12.,  14.,  16.,  18.,  20.,  22.,  24.,  26.,  28.,
        30.,  32.,  34.,  36.,  38.,  40.,  42.,  44.,  46.,  48.,  50.,  52.,
        54.,  56.,  58.,  60.,  62.,  64.,  66.,  68.,  70.,  72.,  74.,  76.,
        78.,  80.,  82.,  84.,  86.,  88.,  90.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.0 4.0 ... 354.0 356.0 358.0</div><input id='attrs-0db714fd-f906-4de9-8b41-e9e850591a96' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0db714fd-f906-4de9-8b41-e9e850591a96' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c3c7f005-174a-4986-9993-618433bd0483' class='xr-var-data-in' type='checkbox'><label for='data-c3c7f005-174a-4986-9993-618433bd0483' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>actual_range :</span></dt><dd>[0.0, 358.0]</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd><dt><span>description :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([  0.,   2.,   4.,   6.,   8.,  10.,  12.,  14.,  16.,  18.,  20.,  22.,
        24.,  26.,  28.,  30.,  32.,  34.,  36.,  38.,  40.,  42.,  44.,  46.,
        48.,  50.,  52.,  54.,  56.,  58.,  60.,  62.,  64.,  66.,  68.,  70.,
        72.,  74.,  76.,  78.,  80.,  82.,  84.,  86.,  88.,  90.,  92.,  94.,
        96.,  98., 100., 102., 104., 106., 108., 110., 112., 114., 116., 118.,
       120., 122., 124., 126., 128., 130., 132., 134., 136., 138., 140., 142.,
       144., 146., 148., 150., 152., 154., 156., 158., 160., 162., 164., 166.,
       168., 170., 172., 174., 176., 178., 180., 182., 184., 186., 188., 190.,
       192., 194., 196., 198., 200., 202., 204., 206., 208., 210., 212., 214.,
       216., 218., 220., 222., 224., 226., 228., 230., 232., 234., 236., 238.,
       240., 242., 244., 246., 248., 250., 252., 254., 256., 258., 260., 262.,
       264., 266., 268., 270., 272., 274., 276., 278., 280., 282., 284., 286.,
       288., 290., 292., 294., 296., 298., 300., 302., 304., 306., 308., 310.,
       312., 314., 316., 318., 320., 322., 324., 326., 328., 330., 332., 334.,
       336., 338., 340., 342., 344., 346., 348., 350., 352., 354., 356., 358.],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>0000-01-01 00:00:00 ... 2000-01-...</div><input id='attrs-9a29ea01-f7e7-42a7-b442-f9e8f7bee14c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9a29ea01-f7e7-42a7-b442-f9e8f7bee14c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bf182a8f-348d-490a-8386-f5ab8e119866' class='xr-var-data-in' type='checkbox'><label for='data-bf182a8f-348d-490a-8386-f5ab8e119866' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>actual_range :</span></dt><dd>[0.0, 730000.0]</dd><dt><span>description :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeNoLeap(0, 1, 1, 0, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(1, 1, 1, 0, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(2, 1, 1, 0, 0, 0, 0, has_year_zero=True), ...,
       cftime.DatetimeNoLeap(1998, 1, 1, 0, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(1999, 1, 1, 0, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(2000, 1, 1, 0, 0, 0, 0, has_year_zero=True)],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-34ed1ff9-6098-47f0-a951-abf979358a1d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-34ed1ff9-6098-47f0-a951-abf979358a1d' class='xr-section-summary' >Data variables: <span>(14)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>air_mean</span></div><div class='xr-var-dims'>(time, MCrun, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;</div><input id='attrs-125ffa12-ffff-47fc-b179-af0240dcb830' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-125ffa12-ffff-47fc-b179-af0240dcb830' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a00439d9-7f5b-4732-a83b-14e2f3a1501b' class='xr-var-data-in' type='checkbox'><label for='data-a00439d9-7f5b-4732-a83b-14e2f3a1501b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_id :</span></dt><dd>11</dd><dt><span>GRIB_name :</span></dt><dd>TMP</dd><dt><span>actual_range :</span></dt><dd>[-10.047584533691406, 7.44861364364624]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>level_desc :</span></dt><dd>2m</dd><dt><span>long_name :</span></dt><dd>Air Temperature at Surface</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>statistic :</span></dt><dd>Ensemble Mean</dd><dt><span>units :</span></dt><dd>degK</dd><dt><span>valid_range :</span></dt><dd>[-20.0, 20.0]</dd><dt><span>var_desc :</span></dt><dd>Air temperature</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.44 GiB </td>
                        <td> 1.25 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2001, 20, 91, 180) </td>
                        <td> (1, 20, 91, 180) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2002 Tasks </td>
                        <td> 2001 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="482" height="98" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2001</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="190" y1="33" x2="204" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="33" style="stroke-width:2" />
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 204.9485979497544,14.948597949754403 204.9485979497544,48.868586287861845 190.0,33.919988338107444" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="228" y2="0" style="stroke-width:2" />
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="228" y1="0" x2="242" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 228.00223047569102,0.0 242.95082842544542,14.948597949754403 204.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />
  <line x1="204" y1="48" x2="242" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />
  <line x1="242" y1="14" x2="242" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="204.9485979497544,14.948597949754403 242.95082842544542,14.948597949754403 242.95082842544542,48.868586287861845 204.9485979497544,48.868586287861845" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="223.949713" y="68.868586" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="262.950828" y="31.908592" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,262.950828,31.908592)">91</text>
  <text x="187.474299" y="61.394287" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,187.474299,61.394287)">20</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>air_spread</span></div><div class='xr-var-dims'>(time, MCrun, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;</div><input id='attrs-226fda0a-e3a2-4150-a819-844b27e3a318' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-226fda0a-e3a2-4150-a819-844b27e3a318' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-212e26e9-e860-4cc4-a457-a7f9aa972e7c' class='xr-var-data-in' type='checkbox'><label for='data-212e26e9-e860-4cc4-a457-a7f9aa972e7c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_id :</span></dt><dd>11</dd><dt><span>GRIB_name :</span></dt><dd>TMP</dd><dt><span>actual_range :</span></dt><dd>[0.08871963620185852, 3.1603903770446777]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>level_desc :</span></dt><dd>2m</dd><dt><span>long_name :</span></dt><dd>Air Temperature at Surface</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>statistic :</span></dt><dd>Ensemble Spread</dd><dt><span>units :</span></dt><dd>degK</dd><dt><span>valid_range :</span></dt><dd>[-20.0, 20.0]</dd><dt><span>var_desc :</span></dt><dd>Air temperature</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.44 GiB </td>
                        <td> 1.25 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2001, 20, 91, 180) </td>
                        <td> (1, 20, 91, 180) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2002 Tasks </td>
                        <td> 2001 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="482" height="98" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2001</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="190" y1="33" x2="204" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="33" style="stroke-width:2" />
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 204.9485979497544,14.948597949754403 204.9485979497544,48.868586287861845 190.0,33.919988338107444" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="228" y2="0" style="stroke-width:2" />
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="228" y1="0" x2="242" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 228.00223047569102,0.0 242.95082842544542,14.948597949754403 204.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />
  <line x1="204" y1="48" x2="242" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />
  <line x1="242" y1="14" x2="242" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="204.9485979497544,14.948597949754403 242.95082842544542,14.948597949754403 242.95082842544542,48.868586287861845 204.9485979497544,48.868586287861845" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="223.949713" y="68.868586" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="262.950828" y="31.908592" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,262.950828,31.908592)">91</text>
  <text x="187.474299" y="61.394287" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,187.474299,61.394287)">20</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hgt500_mean</span></div><div class='xr-var-dims'>(time, MCrun, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;</div><input id='attrs-63b3d276-7f28-4bf0-a6fa-eb542eaceba1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-63b3d276-7f28-4bf0-a6fa-eb542eaceba1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f8f4c492-f500-4f43-9afd-a538eb50763e' class='xr-var-data-in' type='checkbox'><label for='data-f8f4c492-f500-4f43-9afd-a538eb50763e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_id :</span></dt><dd>7</dd><dt><span>GRIB_name :</span></dt><dd>HGT</dd><dt><span>actual_range :</span></dt><dd>[-102.17818450927734, 182.5933074951172]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>level_desc :</span></dt><dd>500hPa</dd><dt><span>long_name :</span></dt><dd>Geopotential Height on 500hPa pressure level</dd><dt><span>standard_name :</span></dt><dd>geopotential_height_500hPa</dd><dt><span>statistic :</span></dt><dd>Ensemble Mean</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>valid_range :</span></dt><dd>[-200.0, 200.0]</dd><dt><span>var_desc :</span></dt><dd>Geopotential height at 500hPa</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.44 GiB </td>
                        <td> 1.25 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2001, 20, 91, 180) </td>
                        <td> (1, 20, 91, 180) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2002 Tasks </td>
                        <td> 2001 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="482" height="98" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2001</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="190" y1="33" x2="204" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="33" style="stroke-width:2" />
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 204.9485979497544,14.948597949754403 204.9485979497544,48.868586287861845 190.0,33.919988338107444" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="228" y2="0" style="stroke-width:2" />
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="228" y1="0" x2="242" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 228.00223047569102,0.0 242.95082842544542,14.948597949754403 204.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />
  <line x1="204" y1="48" x2="242" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />
  <line x1="242" y1="14" x2="242" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="204.9485979497544,14.948597949754403 242.95082842544542,14.948597949754403 242.95082842544542,48.868586287861845 204.9485979497544,48.868586287861845" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="223.949713" y="68.868586" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="262.950828" y="31.908592" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,262.950828,31.908592)">91</text>
  <text x="187.474299" y="61.394287" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,187.474299,61.394287)">20</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hgt500_spread</span></div><div class='xr-var-dims'>(time, MCrun, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;</div><input id='attrs-7850d7a6-506a-4ade-9652-c82a5c1ecf46' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7850d7a6-506a-4ade-9652-c82a5c1ecf46' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e359233e-cbb7-4572-acde-be2bf1fefb70' class='xr-var-data-in' type='checkbox'><label for='data-e359233e-cbb7-4572-acde-be2bf1fefb70' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_id :</span></dt><dd>7</dd><dt><span>GRIB_name :</span></dt><dd>HGT</dd><dt><span>actual_range :</span></dt><dd>[2.8259119987487793, 44.6590576171875]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>level_desc :</span></dt><dd>500hPa</dd><dt><span>long_name :</span></dt><dd>Geopotential Height on 500hPa pressure level</dd><dt><span>standard_name :</span></dt><dd>geopotential_height_500hPa</dd><dt><span>statistic :</span></dt><dd>Ensemble Spread</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>valid_range :</span></dt><dd>[-200.0, 200.0]</dd><dt><span>var_desc :</span></dt><dd>Geopotential height at 500hPa</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.44 GiB </td>
                        <td> 1.25 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2001, 20, 91, 180) </td>
                        <td> (1, 20, 91, 180) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2002 Tasks </td>
                        <td> 2001 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="482" height="98" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2001</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="190" y1="33" x2="204" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="33" style="stroke-width:2" />
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 204.9485979497544,14.948597949754403 204.9485979497544,48.868586287861845 190.0,33.919988338107444" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="228" y2="0" style="stroke-width:2" />
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="228" y1="0" x2="242" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 228.00223047569102,0.0 242.95082842544542,14.948597949754403 204.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />
  <line x1="204" y1="48" x2="242" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />
  <line x1="242" y1="14" x2="242" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="204.9485979497544,14.948597949754403 242.95082842544542,14.948597949754403 242.95082842544542,48.868586287861845 204.9485979497544,48.868586287861845" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="223.949713" y="68.868586" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="262.950828" y="31.908592" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,262.950828,31.908592)">91</text>
  <text x="187.474299" y="61.394287" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,187.474299,61.394287)">20</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pdsi_mean</span></div><div class='xr-var-dims'>(time, MCrun, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;</div><input id='attrs-679b816d-1ec6-446f-84b9-7b3f27bad075' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-679b816d-1ec6-446f-84b9-7b3f27bad075' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9ce455f0-bc11-453c-93e6-b734bb710e9e' class='xr-var-data-in' type='checkbox'><label for='data-9ce455f0-bc11-453c-93e6-b734bb710e9e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_id :</span></dt><dd></dd><dt><span>GRIB_name :</span></dt><dd></dd><dt><span>actual_range :</span></dt><dd>[-17.510055541992188, 17.597644805908203]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>level_desc :</span></dt><dd>Surface</dd><dt><span>long_name :</span></dt><dd>Self-Calibrated Palmer Drought Severity Index (Penman-Monteith evapotranspiration)</dd><dt><span>standard_name :</span></dt><dd>self_calibrated_palmer_drought_severity_index</dd><dt><span>statistic :</span></dt><dd>Ensemble Mean</dd><dt><span>units :</span></dt><dd></dd><dt><span>valid_range :</span></dt><dd>[-40.0, 40.0]</dd><dt><span>var_desc :</span></dt><dd>Self-Calibrated Palmer Drought Severity Index</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.44 GiB </td>
                        <td> 1.25 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2001, 20, 91, 180) </td>
                        <td> (1, 20, 91, 180) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2002 Tasks </td>
                        <td> 2001 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="482" height="98" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2001</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="190" y1="33" x2="204" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="33" style="stroke-width:2" />
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 204.9485979497544,14.948597949754403 204.9485979497544,48.868586287861845 190.0,33.919988338107444" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="228" y2="0" style="stroke-width:2" />
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="228" y1="0" x2="242" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 228.00223047569102,0.0 242.95082842544542,14.948597949754403 204.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />
  <line x1="204" y1="48" x2="242" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />
  <line x1="242" y1="14" x2="242" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="204.9485979497544,14.948597949754403 242.95082842544542,14.948597949754403 242.95082842544542,48.868586287861845 204.9485979497544,48.868586287861845" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="223.949713" y="68.868586" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="262.950828" y="31.908592" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,262.950828,31.908592)">91</text>
  <text x="187.474299" y="61.394287" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,187.474299,61.394287)">20</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pdsi_spread</span></div><div class='xr-var-dims'>(time, MCrun, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;</div><input id='attrs-c743b25d-b663-4cc2-89e2-c9dac1cc1337' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c743b25d-b663-4cc2-89e2-c9dac1cc1337' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-394c8e17-62bd-4ef4-b37e-9105fdc8327a' class='xr-var-data-in' type='checkbox'><label for='data-394c8e17-62bd-4ef4-b37e-9105fdc8327a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_id :</span></dt><dd></dd><dt><span>GRIB_name :</span></dt><dd></dd><dt><span>actual_range :</span></dt><dd>[0.0, 9.946952819824219]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>level_desc :</span></dt><dd>Surface</dd><dt><span>long_name :</span></dt><dd>Self-Calibrated Palmer Drought Severity Index (Penman-Monteith evapotranspiration)</dd><dt><span>standard_name :</span></dt><dd>self_calibrated_palmer_drought_severity_index</dd><dt><span>statistic :</span></dt><dd>Ensemble Spread</dd><dt><span>units :</span></dt><dd></dd><dt><span>valid_range :</span></dt><dd>[-40.0, 40.0]</dd><dt><span>var_desc :</span></dt><dd>Self-Calibrated Palmer Drought Severity Index</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.44 GiB </td>
                        <td> 1.25 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2001, 20, 91, 180) </td>
                        <td> (1, 20, 91, 180) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2002 Tasks </td>
                        <td> 2001 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="482" height="98" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2001</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="190" y1="33" x2="204" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="33" style="stroke-width:2" />
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 204.9485979497544,14.948597949754403 204.9485979497544,48.868586287861845 190.0,33.919988338107444" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="228" y2="0" style="stroke-width:2" />
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="228" y1="0" x2="242" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 228.00223047569102,0.0 242.95082842544542,14.948597949754403 204.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />
  <line x1="204" y1="48" x2="242" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />
  <line x1="242" y1="14" x2="242" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="204.9485979497544,14.948597949754403 242.95082842544542,14.948597949754403 242.95082842544542,48.868586287861845 204.9485979497544,48.868586287861845" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="223.949713" y="68.868586" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="262.950828" y="31.908592" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,262.950828,31.908592)">91</text>
  <text x="187.474299" y="61.394287" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,187.474299,61.394287)">20</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pr_wtr_mean</span></div><div class='xr-var-dims'>(time, MCrun, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;</div><input id='attrs-6a1d3de2-828a-432b-8213-fc34225917c6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6a1d3de2-828a-432b-8213-fc34225917c6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6c724eda-fab0-44f7-be1d-904e2b86d2e7' class='xr-var-data-in' type='checkbox'><label for='data-6c724eda-fab0-44f7-be1d-904e2b86d2e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_id :</span></dt><dd>54</dd><dt><span>GRIB_name :</span></dt><dd>PWATeatm</dd><dt><span>actual_range :</span></dt><dd>[-12.39836597442627, 11.691256523132324]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>level_desc :</span></dt><dd>Surface</dd><dt><span>long_name :</span></dt><dd>Precipitable Water for Entire Atmosphere</dd><dt><span>standard_name :</span></dt><dd>atmosphere_water_vapor_content</dd><dt><span>statistic :</span></dt><dd>Ensemble Mean</dd><dt><span>units :</span></dt><dd>kg/m^2</dd><dt><span>valid_range :</span></dt><dd>[-20.0, 20.0]</dd><dt><span>var_desc :</span></dt><dd>Precipitable water</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.44 GiB </td>
                        <td> 1.25 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2001, 20, 91, 180) </td>
                        <td> (1, 20, 91, 180) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2002 Tasks </td>
                        <td> 2001 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="482" height="98" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2001</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="190" y1="33" x2="204" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="33" style="stroke-width:2" />
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 204.9485979497544,14.948597949754403 204.9485979497544,48.868586287861845 190.0,33.919988338107444" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="228" y2="0" style="stroke-width:2" />
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="228" y1="0" x2="242" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 228.00223047569102,0.0 242.95082842544542,14.948597949754403 204.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />
  <line x1="204" y1="48" x2="242" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />
  <line x1="242" y1="14" x2="242" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="204.9485979497544,14.948597949754403 242.95082842544542,14.948597949754403 242.95082842544542,48.868586287861845 204.9485979497544,48.868586287861845" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="223.949713" y="68.868586" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="262.950828" y="31.908592" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,262.950828,31.908592)">91</text>
  <text x="187.474299" y="61.394287" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,187.474299,61.394287)">20</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pr_wtr_spread</span></div><div class='xr-var-dims'>(time, MCrun, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;</div><input id='attrs-2abd163c-c13a-4a9e-baa5-65f27ba1b1f3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2abd163c-c13a-4a9e-baa5-65f27ba1b1f3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af9b4111-0dd9-4a89-b73a-73379b7e5fe0' class='xr-var-data-in' type='checkbox'><label for='data-af9b4111-0dd9-4a89-b73a-73379b7e5fe0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_id :</span></dt><dd>54</dd><dt><span>GRIB_name :</span></dt><dd>PWATeatm</dd><dt><span>actual_range :</span></dt><dd>[0.013965907506644726, 5.044125556945801]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>level_desc :</span></dt><dd>Surface</dd><dt><span>long_name :</span></dt><dd>Precipitable Water for Entire Atmosphere</dd><dt><span>standard_name :</span></dt><dd>atmosphere_water_vapor_content</dd><dt><span>statistic :</span></dt><dd>Ensemble Spread</dd><dt><span>units :</span></dt><dd>kg/m^2</dd><dt><span>valid_range :</span></dt><dd>[-20.0, 20.0]</dd><dt><span>var_desc :</span></dt><dd>Precipitable water</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.44 GiB </td>
                        <td> 1.25 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2001, 20, 91, 180) </td>
                        <td> (1, 20, 91, 180) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2002 Tasks </td>
                        <td> 2001 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="482" height="98" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2001</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="190" y1="33" x2="204" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="33" style="stroke-width:2" />
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 204.9485979497544,14.948597949754403 204.9485979497544,48.868586287861845 190.0,33.919988338107444" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="228" y2="0" style="stroke-width:2" />
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="228" y1="0" x2="242" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 228.00223047569102,0.0 242.95082842544542,14.948597949754403 204.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />
  <line x1="204" y1="48" x2="242" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />
  <line x1="242" y1="14" x2="242" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="204.9485979497544,14.948597949754403 242.95082842544542,14.948597949754403 242.95082842544542,48.868586287861845 204.9485979497544,48.868586287861845" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="223.949713" y="68.868586" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="262.950828" y="31.908592" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,262.950828,31.908592)">91</text>
  <text x="187.474299" y="61.394287" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,187.474299,61.394287)">20</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>prate_mean</span></div><div class='xr-var-dims'>(time, MCrun, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;</div><input id='attrs-fb8fa80a-7811-4eb2-adba-6eb1353b3d5e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fb8fa80a-7811-4eb2-adba-6eb1353b3d5e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-efb25c41-38bd-42b4-ba0b-da954794329a' class='xr-var-data-in' type='checkbox'><label for='data-efb25c41-38bd-42b4-ba0b-da954794329a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_id :</span></dt><dd>59</dd><dt><span>GRIB_name :</span></dt><dd>PRATEsfcAvg</dd><dt><span>actual_range :</span></dt><dd>[-6.347615271806717e-05, 6.654565368080512e-05]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>level_desc :</span></dt><dd>Surface</dd><dt><span>long_name :</span></dt><dd>Precipitation Rate at Surface</dd><dt><span>standard_name :</span></dt><dd>precipitation_flux</dd><dt><span>statistic :</span></dt><dd>Ensemble Mean</dd><dt><span>units :</span></dt><dd>kg/m^2/s</dd><dt><span>valid_range :</span></dt><dd>[-0.00019999999494757503, 0.00019999999494757503]</dd><dt><span>var_desc :</span></dt><dd>Precipitation rate at surface</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.44 GiB </td>
                        <td> 1.25 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2001, 20, 91, 180) </td>
                        <td> (1, 20, 91, 180) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2002 Tasks </td>
                        <td> 2001 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="482" height="98" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2001</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="190" y1="33" x2="204" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="33" style="stroke-width:2" />
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 204.9485979497544,14.948597949754403 204.9485979497544,48.868586287861845 190.0,33.919988338107444" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="228" y2="0" style="stroke-width:2" />
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="228" y1="0" x2="242" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 228.00223047569102,0.0 242.95082842544542,14.948597949754403 204.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />
  <line x1="204" y1="48" x2="242" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />
  <line x1="242" y1="14" x2="242" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="204.9485979497544,14.948597949754403 242.95082842544542,14.948597949754403 242.95082842544542,48.868586287861845 204.9485979497544,48.868586287861845" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="223.949713" y="68.868586" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="262.950828" y="31.908592" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,262.950828,31.908592)">91</text>
  <text x="187.474299" y="61.394287" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,187.474299,61.394287)">20</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>prate_spread</span></div><div class='xr-var-dims'>(time, MCrun, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;</div><input id='attrs-5cf40b10-6245-45ec-a97d-d5733f06600c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5cf40b10-6245-45ec-a97d-d5733f06600c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc263adb-3232-49b9-a08c-a6de499109d2' class='xr-var-data-in' type='checkbox'><label for='data-cc263adb-3232-49b9-a08c-a6de499109d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_id :</span></dt><dd>59</dd><dt><span>GRIB_name :</span></dt><dd>PRATEsfcAvg</dd><dt><span>actual_range :</span></dt><dd>[5.9459235757231e-08, 3.3992426324402913e-05]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>level_desc :</span></dt><dd>Surface</dd><dt><span>long_name :</span></dt><dd>Precipitation Rate at Surface</dd><dt><span>standard_name :</span></dt><dd>precipitation_flux</dd><dt><span>statistic :</span></dt><dd>Ensemble Spread</dd><dt><span>units :</span></dt><dd>kg/m^2/s</dd><dt><span>valid_range :</span></dt><dd>[-0.00019999999494757503, 0.00019999999494757503]</dd><dt><span>var_desc :</span></dt><dd>Precipitation rate at surface</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.44 GiB </td>
                        <td> 1.25 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2001, 20, 91, 180) </td>
                        <td> (1, 20, 91, 180) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2002 Tasks </td>
                        <td> 2001 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="482" height="98" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2001</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="190" y1="33" x2="204" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="33" style="stroke-width:2" />
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 204.9485979497544,14.948597949754403 204.9485979497544,48.868586287861845 190.0,33.919988338107444" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="228" y2="0" style="stroke-width:2" />
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="228" y1="0" x2="242" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 228.00223047569102,0.0 242.95082842544542,14.948597949754403 204.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />
  <line x1="204" y1="48" x2="242" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />
  <line x1="242" y1="14" x2="242" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="204.9485979497544,14.948597949754403 242.95082842544542,14.948597949754403 242.95082842544542,48.868586287861845 204.9485979497544,48.868586287861845" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="223.949713" y="68.868586" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="262.950828" y="31.908592" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,262.950828,31.908592)">91</text>
  <text x="187.474299" y="61.394287" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,187.474299,61.394287)">20</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>prmsl_mean</span></div><div class='xr-var-dims'>(time, MCrun, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;</div><input id='attrs-0c766ada-c5d4-474f-8ef0-f62e3ef960b4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0c766ada-c5d4-474f-8ef0-f62e3ef960b4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f8f488d4-20fe-4025-bffc-70cf9dc3cbd3' class='xr-var-data-in' type='checkbox'><label for='data-f8f488d4-20fe-4025-bffc-70cf9dc3cbd3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_id :</span></dt><dd>2</dd><dt><span>GRIB_name :</span></dt><dd>PRMSL</dd><dt><span>actual_range :</span></dt><dd>[-672.8883666992188, 1146.925048828125]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>level_desc :</span></dt><dd>Mean Sea Level</dd><dt><span>long_name :</span></dt><dd>Pressure at Mean Sea Level</dd><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>statistic :</span></dt><dd>Ensemble Mean</dd><dt><span>units :</span></dt><dd>Pa</dd><dt><span>valid_range :</span></dt><dd>[-2000.0, 2000.0]</dd><dt><span>var_desc :</span></dt><dd>Mean Sea Level Pressure</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.44 GiB </td>
                        <td> 1.25 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2001, 20, 91, 180) </td>
                        <td> (1, 20, 91, 180) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2002 Tasks </td>
                        <td> 2001 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="482" height="98" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2001</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="190" y1="33" x2="204" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="33" style="stroke-width:2" />
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 204.9485979497544,14.948597949754403 204.9485979497544,48.868586287861845 190.0,33.919988338107444" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="228" y2="0" style="stroke-width:2" />
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="228" y1="0" x2="242" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 228.00223047569102,0.0 242.95082842544542,14.948597949754403 204.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />
  <line x1="204" y1="48" x2="242" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />
  <line x1="242" y1="14" x2="242" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="204.9485979497544,14.948597949754403 242.95082842544542,14.948597949754403 242.95082842544542,48.868586287861845 204.9485979497544,48.868586287861845" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="223.949713" y="68.868586" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="262.950828" y="31.908592" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,262.950828,31.908592)">91</text>
  <text x="187.474299" y="61.394287" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,187.474299,61.394287)">20</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>prmsl_spread</span></div><div class='xr-var-dims'>(time, MCrun, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;</div><input id='attrs-d35419a0-a3b9-4cee-ab41-c24db1c6e6b1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d35419a0-a3b9-4cee-ab41-c24db1c6e6b1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4ac1261e-46e8-40ed-a631-b8c395da80c4' class='xr-var-data-in' type='checkbox'><label for='data-4ac1261e-46e8-40ed-a631-b8c395da80c4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_id :</span></dt><dd>2</dd><dt><span>GRIB_name :</span></dt><dd>PRMSL</dd><dt><span>actual_range :</span></dt><dd>[13.322461128234863, 368.0671691894531]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>level_desc :</span></dt><dd>Mean Sea Level</dd><dt><span>long_name :</span></dt><dd>Pressure at Mean Sea Level</dd><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>statistic :</span></dt><dd>Ensemble Spread</dd><dt><span>units :</span></dt><dd>Pa</dd><dt><span>valid_range :</span></dt><dd>[-2000.0, 2000.0]</dd><dt><span>var_desc :</span></dt><dd>Mean Sea Level Pressure</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.44 GiB </td>
                        <td> 1.25 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2001, 20, 91, 180) </td>
                        <td> (1, 20, 91, 180) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2002 Tasks </td>
                        <td> 2001 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="482" height="98" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2001</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="190" y1="33" x2="204" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="33" style="stroke-width:2" />
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 204.9485979497544,14.948597949754403 204.9485979497544,48.868586287861845 190.0,33.919988338107444" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="228" y2="0" style="stroke-width:2" />
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="228" y1="0" x2="242" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 228.00223047569102,0.0 242.95082842544542,14.948597949754403 204.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />
  <line x1="204" y1="48" x2="242" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />
  <line x1="242" y1="14" x2="242" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="204.9485979497544,14.948597949754403 242.95082842544542,14.948597949754403 242.95082842544542,48.868586287861845 204.9485979497544,48.868586287861845" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="223.949713" y="68.868586" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="262.950828" y="31.908592" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,262.950828,31.908592)">91</text>
  <text x="187.474299" y="61.394287" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,187.474299,61.394287)">20</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sst_mean</span></div><div class='xr-var-dims'>(time, MCrun, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;</div><input id='attrs-c6d6e8cc-870f-4b2d-acaf-f7e6a3ae58f4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c6d6e8cc-870f-4b2d-acaf-f7e6a3ae58f4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0d98729a-8655-4a68-9e83-b2270c25c728' class='xr-var-data-in' type='checkbox'><label for='data-0d98729a-8655-4a68-9e83-b2270c25c728' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_id :</span></dt><dd></dd><dt><span>GRIB_name :</span></dt><dd>WTMP</dd><dt><span>actual_range :</span></dt><dd>[-3.817485809326172, 3.932953357696533]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>level_desc :</span></dt><dd>surface</dd><dt><span>long_name :</span></dt><dd>Sea Surface Water Temperature</dd><dt><span>standard_name :</span></dt><dd>sea_surface_water_temperature</dd><dt><span>statistic :</span></dt><dd>Ensemble Mean</dd><dt><span>units :</span></dt><dd>degK</dd><dt><span>valid_range :</span></dt><dd>[-20.0, 20.0]</dd><dt><span>var_desc :</span></dt><dd>Sea surface water temperature</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.44 GiB </td>
                        <td> 1.25 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2001, 20, 91, 180) </td>
                        <td> (1, 20, 91, 180) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2002 Tasks </td>
                        <td> 2001 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="482" height="98" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2001</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="190" y1="33" x2="204" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="33" style="stroke-width:2" />
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 204.9485979497544,14.948597949754403 204.9485979497544,48.868586287861845 190.0,33.919988338107444" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="228" y2="0" style="stroke-width:2" />
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="228" y1="0" x2="242" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 228.00223047569102,0.0 242.95082842544542,14.948597949754403 204.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />
  <line x1="204" y1="48" x2="242" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />
  <line x1="242" y1="14" x2="242" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="204.9485979497544,14.948597949754403 242.95082842544542,14.948597949754403 242.95082842544542,48.868586287861845 204.9485979497544,48.868586287861845" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="223.949713" y="68.868586" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="262.950828" y="31.908592" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,262.950828,31.908592)">91</text>
  <text x="187.474299" y="61.394287" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,187.474299,61.394287)">20</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sst_spread</span></div><div class='xr-var-dims'>(time, MCrun, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 20, 91, 180), meta=np.ndarray&gt;</div><input id='attrs-a846fab4-4e76-4c1f-8289-a7d7354f6e76' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a846fab4-4e76-4c1f-8289-a7d7354f6e76' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dd2b3ded-91a9-4636-aeda-486eae1d4199' class='xr-var-data-in' type='checkbox'><label for='data-dd2b3ded-91a9-4636-aeda-486eae1d4199' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_id :</span></dt><dd></dd><dt><span>GRIB_name :</span></dt><dd>WTMP</dd><dt><span>actual_range :</span></dt><dd>[0.0009252773015759885, 2.0188817977905273]</dd><dt><span>dataset :</span></dt><dd>NOAA Last Millennium Reanalysis version 1.1 Annual Averages</dd><dt><span>level_desc :</span></dt><dd>surface</dd><dt><span>long_name :</span></dt><dd>Sea Surface Water Temperature</dd><dt><span>standard_name :</span></dt><dd>sea_surface_water_temperature</dd><dt><span>statistic :</span></dt><dd>Ensemble Spread</dd><dt><span>units :</span></dt><dd>degK</dd><dt><span>valid_range :</span></dt><dd>[-20.0, 20.0]</dd><dt><span>var_desc :</span></dt><dd>Sea surface water temperature</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.44 GiB </td>
                        <td> 1.25 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2001, 20, 91, 180) </td>
                        <td> (1, 20, 91, 180) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2002 Tasks </td>
                        <td> 2001 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="482" height="98" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >2001</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="190" y1="33" x2="204" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="33" style="stroke-width:2" />
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 204.9485979497544,14.948597949754403 204.9485979497544,48.868586287861845 190.0,33.919988338107444" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="228" y2="0" style="stroke-width:2" />
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="204" y2="14" style="stroke-width:2" />
  <line x1="228" y1="0" x2="242" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 228.00223047569102,0.0 242.95082842544542,14.948597949754403 204.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="204" y1="14" x2="242" y2="14" style="stroke-width:2" />
  <line x1="204" y1="48" x2="242" y2="48" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="204" y1="14" x2="204" y2="48" style="stroke-width:2" />
  <line x1="242" y1="14" x2="242" y2="48" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="204.9485979497544,14.948597949754403 242.95082842544542,14.948597949754403 242.95082842544542,48.868586287861845 204.9485979497544,48.868586287861845" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="223.949713" y="68.868586" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="262.950828" y="31.908592" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,262.950828,31.908592)">91</text>
  <text x="187.474299" y="61.394287" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,187.474299,61.394287)">20</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-b7a6739a-1945-4bd0-bd3b-90425e181260' class='xr-section-summary-in' type='checkbox'  ><label for='section-b7a6739a-1945-4bd0-bd3b-90425e181260' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-00fbc4b9-8999-4720-be02-e4d51e3534d2' class='xr-index-data-in' type='checkbox'/><label for='index-00fbc4b9-8999-4720-be02-e4d51e3534d2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-90.0, -88.0, -86.0, -84.0, -82.0, -80.0, -78.0, -76.0, -74.0,
              -72.0, -70.0, -68.0, -66.0, -64.0, -62.0, -60.0, -58.0, -56.0,
              -54.0, -52.0, -50.0, -48.0, -46.0, -44.0, -42.0, -40.0, -38.0,
              -36.0, -34.0, -32.0, -30.0, -28.0, -26.0, -24.0, -22.0, -20.0,
              -18.0, -16.0, -14.0, -12.0, -10.0,  -8.0,  -6.0,  -4.0,  -2.0,
                0.0,   2.0,   4.0,   6.0,   8.0,  10.0,  12.0,  14.0,  16.0,
               18.0,  20.0,  22.0,  24.0,  26.0,  28.0,  30.0,  32.0,  34.0,
               36.0,  38.0,  40.0,  42.0,  44.0,  46.0,  48.0,  50.0,  52.0,
               54.0,  56.0,  58.0,  60.0,  62.0,  64.0,  66.0,  68.0,  70.0,
               72.0,  74.0,  76.0,  78.0,  80.0,  82.0,  84.0,  86.0,  88.0,
               90.0],
             dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1a9080ce-546d-4b92-b860-f7cba1f06e40' class='xr-index-data-in' type='checkbox'/><label for='index-1a9080ce-546d-4b92-b860-f7cba1f06e40' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  0.0,   2.0,   4.0,   6.0,   8.0,  10.0,  12.0,  14.0,  16.0,
               18.0,
              ...
              340.0, 342.0, 344.0, 346.0, 348.0, 350.0, 352.0, 354.0, 356.0,
              358.0],
             dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-615c460a-0a40-438f-8ec9-22a48b52d0b8' class='xr-index-data-in' type='checkbox'/><label for='index-615c460a-0a40-438f-8ec9-22a48b52d0b8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(CFTimeIndex([0000-01-01 00:00:00, 0001-01-01 00:00:00, 0002-01-01 00:00:00,
             0003-01-01 00:00:00, 0004-01-01 00:00:00, 0005-01-01 00:00:00,
             0006-01-01 00:00:00, 0007-01-01 00:00:00, 0008-01-01 00:00:00,
             0009-01-01 00:00:00,
             ...
             1991-01-01 00:00:00, 1992-01-01 00:00:00, 1993-01-01 00:00:00,
             1994-01-01 00:00:00, 1995-01-01 00:00:00, 1996-01-01 00:00:00,
             1997-01-01 00:00:00, 1998-01-01 00:00:00, 1999-01-01 00:00:00,
             2000-01-01 00:00:00],
            dtype=&#x27;object&#x27;, length=2001, calendar=&#x27;noleap&#x27;, freq=&#x27;AS-JAN&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5c797892-06f2-4869-8340-955406e75e38' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5c797892-06f2-4869-8340-955406e75e38' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>comment :</span></dt><dd>File contains ensemble spread values for each Monte-Carlo reconstruction (MCrun)</dd><dt><span>description :</span></dt><dd>Last Millennium Reanalysis climate field reconstruction for variable: hgt500</dd><dt><span>experiment :</span></dt><dd>productionFinal2_gisgpcc_ccms4_LMRdbv1.1.0_z500</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># take the mean of all MC runs at each lat-lon point at each time</span>
<span class="n">lmr_ds_gridded_mean</span> <span class="o">=</span> <span class="n">lmr_ds_gridded</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;MCrun&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert prate_mean from kg/(m^2*s) to mm/day</span>
<span class="n">prate_unit_conversion</span> <span class="o">=</span> <span class="mi">86400</span>
<span class="n">lmr_ds_gridded_mean</span><span class="o">=</span><span class="n">lmr_ds_gridded_mean</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">prate_m</span><span class="o">=</span><span class="n">lmr_ds_gridded_mean</span><span class="p">[</span><span class="s1">&#39;prate_mean&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">prate_unit_conversion</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a variable for year</span>
<span class="n">lmr_ds_gridded_mean</span> <span class="o">=</span> <span class="n">lmr_ds_gridded_mean</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">lmr_ds_gridded_mean</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a variable for latitude in radians</span>
<span class="n">lmr_ds_gridded_mean</span><span class="o">=</span> <span class="n">lmr_ds_gridded_mean</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">lat_rad</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lmr_ds_gridded_mean</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dashboard">
<h2>Dashboard<a class="headerlink" href="#dashboard" title="Permalink to this heading">#</a></h2>
<p>The final goal of this notebook is to compose a dashboard of useful visualizations that might help us explore our data. Given evidence that volcanic emissions affect cloud formation and surface temperature, let’s add spatial distributions of the surface air temperature and daily precipitation anomalies. In this case, the anomaly will be calculated relative to the immediate past to tease out any effect that might be directly related to an eruption event.</p>
<p>The final dashboard will contain the Hovmüller diagram, the global average SAOD over time, and the two maps. The data displayed on the dashboard will be motivated by the user by way of either a dropdown menu initialized with a list of large volcanic eruptions, or a free text field in which a user can request the dashboard be recalculated for a year not included in the initial list.</p>
<p>For more details about working with widgets, check out the <span class="xref myst">widget primer notebook</span>, but briefly we will need:</p>
<ul class="simple">
<li><p>an initial object or set of objects (like a figure with axes)</p></li>
<li><p>a widget (or two)</p></li>
<li><p>one or more function(s) describing what to do when the widget selection has changed (for a plot this often includes instructions about whether to keep or clear actions done by the previous selection and instructions about updating according to the current selection)</p></li>
</ul>
<section id="non-exhaustive-list-of-volcanic-events">
<h3>Non-exhaustive list of volcanic events<a class="headerlink" href="#non-exhaustive-list-of-volcanic-events" title="Permalink to this heading">#</a></h3>
<p>The list of volcanic events below will provide a scope of events to investigate. This list is based on N-TREND analysis and meet the following criteria:</p>
<ol class="arabic simple">
<li><p>since 750 CE</p></li>
<li><p>a global forcing as large as Krakatoa</p></li>
<li><p>a tropical source
Each event with an identified source has a label in the <code class="docutils literal notranslate"><span class="pre">erup_names</span></code> list, all other events are associated with placeholding question marks.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">erup_yrs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">916</span><span class="p">,</span><span class="mi">940</span><span class="p">,</span><span class="mi">1108</span><span class="p">,</span><span class="mi">1171</span><span class="p">,</span><span class="mi">1191</span><span class="p">,</span><span class="mi">1230</span><span class="p">,</span><span class="mi">1258</span><span class="p">,</span><span class="mi">1276</span><span class="p">,</span><span class="mi">1286</span><span class="p">,</span><span class="mi">1345</span><span class="p">,</span><span class="mi">1453</span><span class="p">,</span><span class="mi">1458</span><span class="p">,</span><span class="mi">1595</span><span class="p">,</span><span class="mi">1601</span><span class="p">,</span><span class="mi">1641</span><span class="p">,</span><span class="mi">1695</span><span class="p">,</span><span class="mi">1784</span><span class="p">,</span><span class="mi">1809</span><span class="p">,</span><span class="mi">1816</span><span class="p">,</span><span class="mi">1832</span><span class="p">,</span><span class="mi">1836</span><span class="p">,</span><span class="mi">1884</span><span class="p">]</span>
<span class="n">erup_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;?&#39;</span><span class="p">,</span><span class="s1">&#39;Eldgjá&#39;</span><span class="p">,</span><span class="s1">&#39;UE 1108&#39;</span><span class="p">,</span><span class="s1">&#39;?&#39;</span><span class="p">,</span><span class="s1">&#39;?&#39;</span><span class="p">,</span><span class="s1">&#39;UE 1230&#39;</span><span class="p">,</span><span class="s1">&#39;Samalas&#39;</span><span class="p">,</span><span class="s1">&#39;?&#39;</span><span class="p">,</span><span class="s2">&quot;Quilotoa&quot;</span><span class="p">,</span><span class="s2">&quot;El Chichon&quot;</span><span class="p">,</span><span class="s2">&quot;?&quot;</span><span class="p">,</span><span class="s1">&#39;Kuwae&#39;</span><span class="p">]</span>
<span class="n">erup_names</span> <span class="o">=</span> <span class="n">erup_names</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;?&quot;</span><span class="p">,</span><span class="s2">&quot;Huaynaputina&quot;</span><span class="p">,</span><span class="s2">&quot;Parker&quot;</span><span class="p">,</span><span class="s2">&quot;UE 1695&quot;</span><span class="p">,</span><span class="s2">&quot;Laki&quot;</span><span class="p">,</span><span class="s2">&quot;UE 1809&quot;</span><span class="p">,</span><span class="s2">&quot;Tambora&quot;</span><span class="p">,</span><span class="s2">&quot;?&quot;</span><span class="p">,</span><span class="s2">&quot;?&quot;</span><span class="p">,</span><span class="s2">&quot;Krakatau&quot;</span><span class="p">]</span>

<span class="n">n_events</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">erup_yrs</span><span class="p">)</span>

<span class="n">erup_d</span> <span class="o">=</span> <span class="p">{</span><span class="n">erup_yrs</span><span class="p">[</span><span class="n">ik</span><span class="p">]:</span><span class="n">erup_names</span><span class="p">[</span><span class="n">ik</span><span class="p">]</span> <span class="k">for</span> <span class="n">ik</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">erup_yrs</span><span class="p">))}</span>
</pre></div>
</div>
</div>
</div>
<p>A few misc parameters</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up plotting parameters</span>
<span class="n">before</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">after</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="n">zrange</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">nc</span> <span class="o">=</span> <span class="mi">21</span><span class="p">;</span>  <span class="n">fnt</span><span class="o">=</span><span class="s1">&#39;sans-serif&#39;</span>
<span class="n">view</span> <span class="o">=</span> <span class="s1">&#39;global&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="precompute-anomalies">
<h3>Precompute anomalies<a class="headerlink" href="#precompute-anomalies" title="Permalink to this heading">#</a></h3>
<p>For the dashboard, we are specifically interested in the climate response to an event, so it makes sense to subtract the rolling mean from a short period prior. Xarray will once more come to the rescue with its <code class="docutils literal notranslate"><span class="pre">.rolling().mean()</span></code> function combination that specifies how the window should be selected and what should be done with the identified values (in the case of <code class="docutils literal notranslate"><span class="pre">.mean()</span></code>, they should be averaged).</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">make_demeaned()</span></code> selects data from the specified year and subtracts off the rolling average.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rolling_mean</span> <span class="o">=</span> <span class="n">lmr_ds_gridded_mean</span><span class="p">[[</span><span class="s1">&#39;hgt500_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;air_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;prate_m&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="c1">#.isel(time=slice(913,916))</span>

<span class="k">def</span> <span class="nf">make_demeaned</span><span class="p">(</span><span class="n">erup_yr</span><span class="p">):</span>
    <span class="n">time_arg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">lmr_ds_gridded_mean</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">data</span><span class="o">&gt;</span><span class="n">erup_yr</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">demeaned</span> <span class="o">=</span> <span class="n">lmr_ds_gridded_mean</span><span class="p">[[</span><span class="s1">&#39;hgt500_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;air_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;prate_m&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time_arg1</span><span class="p">)</span><span class="o">-</span><span class="n">rolling_mean</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time_arg1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">demeaned</span>
</pre></div>
</div>
</div>
</div>
<p>Sometimes widgets respond promptly, but sometimes they don’t. For expediency, we’ll pre-calculate de-meaned values for each of the events in the initial list. As part of that pre-compute, we’ll build a list of max and min mean air temperature and precipitation rate values which will likely contain the bounding values (or close) that we will want to construct our color scales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">demeaned_d</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">air_lim</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prate_lim</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">erup_yr</span> <span class="ow">in</span> <span class="n">erup_yrs</span><span class="p">:</span>    
    <span class="n">demeaned_d</span><span class="p">[</span><span class="n">erup_yr</span><span class="p">]</span><span class="o">=</span> <span class="n">make_demeaned</span><span class="p">(</span><span class="n">erup_yr</span><span class="p">)</span>
    <span class="n">air_lim</span> <span class="o">+=</span> <span class="p">[</span><span class="n">demeaned_d</span><span class="p">[</span><span class="n">erup_yr</span><span class="p">][</span><span class="s1">&#39;air_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> 
                <span class="n">demeaned_d</span><span class="p">[</span><span class="n">erup_yr</span><span class="p">][</span><span class="s1">&#39;air_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="n">prate_lim</span> <span class="o">+=</span> <span class="p">[</span><span class="n">demeaned_d</span><span class="p">[</span><span class="n">erup_yr</span><span class="p">][</span><span class="s1">&#39;prate_m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> 
                <span class="n">demeaned_d</span><span class="p">[</span><span class="n">erup_yr</span><span class="p">][</span><span class="s1">&#39;prate_m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>In order to cleanly update the dashboard, each subfigure will need to be cleared, have any axis configuration reapplied, and finally be replotted. It is not strictly necessary to split this into two functions, but splitting it into two functions, one that sets things up and another that plots, is a good habit for other widget use cases.</p>
</section>
<section id="building-the-dashboard">
<h3>Building the dashboard<a class="headerlink" href="#building-the-dashboard" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate scalar mappables (colorbars)</span>
<span class="c1"># evolv2k AOD</span>
<span class="n">vol_vlims</span> <span class="o">=</span> <span class="p">[</span><span class="n">vol_ds</span><span class="o">.</span><span class="n">aod550</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vol_ds</span><span class="o">.</span><span class="n">aod550</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">ax0_sm</span> <span class="o">=</span> <span class="n">make_scalar_mappable</span><span class="p">(</span><span class="n">vol_vlims</span><span class="p">,</span> <span class="s1">&#39;magma&#39;</span><span class="p">)</span>

<span class="c1"># LMR: temp</span>
<span class="n">ax2_Li_1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">air_lim</span><span class="p">))</span>
<span class="n">ax2_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">ax2_Li_1</span><span class="p">,</span> <span class="n">ax2_Li_1</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2_sm</span> <span class="o">=</span> <span class="n">make_scalar_mappable</span><span class="p">([</span><span class="n">ax2_Li_1</span><span class="p">,</span> <span class="o">-</span><span class="n">ax2_Li_1</span><span class="p">],</span> <span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>

<span class="c1"># LMR: precip</span>
<span class="n">ax3_Li_1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">prate_lim</span><span class="p">))</span>
<span class="n">ax3_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">ax3_Li_1</span><span class="p">,</span> <span class="n">ax3_Li_1</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax3_sm</span> <span class="o">=</span> <span class="n">make_scalar_mappable</span><span class="p">([</span><span class="n">ax3_Li_1</span><span class="p">,</span> <span class="o">-</span><span class="n">ax3_Li_1</span><span class="p">],</span> <span class="s1">&#39;BrBG&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tick_lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">sin_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">tick_lat</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
<span class="n">erup_yrs_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">erup_yrs</span><span class="p">)</span>
<span class="n">width</span> <span class="o">=</span> <span class="mi">7</span>
        

<span class="c1"># plot the data for the four frames</span>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="n">ax0_cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>
    <span class="n">erup_yr</span> <span class="o">=</span> <span class="n">val</span>
    <span class="n">erup_yrs_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">erup_yrs</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">erup_yr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">erup_yrs</span><span class="p">:</span>
        <span class="n">prev_erup_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">erup_yrs_array</span><span class="o">&lt;</span><span class="n">erup_yr</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">prev_erup_yr</span> <span class="o">=</span> <span class="n">erup_yrs_array</span><span class="p">[</span><span class="n">prev_erup_ind</span><span class="p">]</span>
        <span class="n">erup_name</span> <span class="o">=</span> <span class="n">erup_d</span><span class="p">[</span><span class="n">prev_erup_yr</span><span class="p">]</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Year=</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1"> years after </span><span class="si">{}</span><span class="s1"> eruption ()&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">erup_yr</span><span class="p">,</span> <span class="n">erup_yr</span><span class="o">-</span><span class="n">prev_erup_yr</span><span class="p">,</span> <span class="n">erup_name</span><span class="p">,</span> <span class="n">prev_erup_yr</span><span class="p">)</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">erup_name</span> <span class="o">=</span> <span class="n">erup_d</span><span class="p">[</span><span class="n">erup_yr</span><span class="p">]</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Year=</span><span class="si">{}</span><span class="s1">, immediate response to </span><span class="si">{}</span><span class="s1"> eruption&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">erup_yr</span><span class="p">,</span> <span class="n">erup_name</span><span class="p">)</span>

    <span class="c1"># pcolor</span>
    <span class="n">itmp_slice</span> <span class="o">=</span> <span class="n">vol_ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">erup_yr</span><span class="o">-</span><span class="n">before</span><span class="p">,</span> <span class="n">erup_yr</span><span class="o">+</span><span class="n">after</span><span class="p">))</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">itmp_slice</span><span class="o">.</span><span class="n">time</span><span class="p">,</span><span class="n">itmp_slice</span><span class="o">.</span><span class="n">lat_rad</span><span class="p">)</span>
    <span class="n">pc</span> <span class="o">=</span> <span class="n">ax0</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span><span class="n">itmp_slice</span><span class="o">.</span><span class="n">aod550</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">ax0_sm</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">ax0_sm</span><span class="o">.</span><span class="n">norm</span><span class="p">)</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;evolv2k AOD&#39;</span><span class="p">,</span><span class="n">fontname</span><span class="o">=</span><span class="n">fnt</span><span class="p">)</span>
    
    <span class="c1"># timeseries</span>
    <span class="n">itmp_slice_yr</span> <span class="o">=</span> <span class="n">vol_ds_year_wm</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">erup_yr</span><span class="p">)</span><span class="o">-</span><span class="n">before</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">erup_yr</span><span class="p">)</span><span class="o">+</span><span class="n">after</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">itmp_slice_yr</span><span class="o">.</span><span class="n">year</span><span class="p">,</span><span class="n">itmp_slice_yr</span><span class="o">.</span><span class="n">weighted_aod550</span><span class="p">,</span><span class="s1">&#39;-o&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    
    <span class="n">ax0</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="c1"># maps</span>
    <span class="n">demeaned</span> <span class="o">=</span> <span class="n">demeaned_d</span><span class="p">[</span><span class="n">erup_yr</span><span class="p">]</span>                     
    <span class="n">tas_c</span><span class="p">,</span> <span class="n">lonc</span> <span class="o">=</span> <span class="n">cutil</span><span class="o">.</span><span class="n">add_cyclic_point</span><span class="p">(</span><span class="n">demeaned</span><span class="p">[</span><span class="s1">&#39;air_mean&#39;</span><span class="p">],</span> <span class="n">demeaned</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">])</span>
    <span class="n">zg_c</span> <span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cutil</span><span class="o">.</span><span class="n">add_cyclic_point</span><span class="p">(</span><span class="n">demeaned</span><span class="p">[</span><span class="s1">&#39;hgt500_mean&#39;</span><span class="p">],</span> <span class="n">demeaned</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">])</span>                     
    <span class="n">cf2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lonc</span><span class="p">,</span><span class="n">demeaned</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">tas_c</span><span class="p">,</span><span class="n">nc</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">ax2_levels</span><span class="p">,</span> 
                       <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="o">**</span><span class="n">cf2_kwargs</span><span class="p">)</span>
    <span class="n">cf2_lines</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">lonc</span><span class="p">,</span><span class="n">demeaned</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="n">zg_c</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">zrange</span><span class="p">,</span><span class="n">zrange</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span>
                            <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                            <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;SAT Anomaly and $Z_</span><span class="si">{500}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">fontname</span><span class="o">=</span><span class="n">fnt</span><span class="p">)</span>

    <span class="n">pr_c</span><span class="p">,</span> <span class="n">lonc</span> <span class="o">=</span> <span class="n">cutil</span><span class="o">.</span><span class="n">add_cyclic_point</span><span class="p">(</span><span class="n">demeaned</span><span class="p">[</span><span class="s1">&#39;prate_m&#39;</span><span class="p">],</span> <span class="n">demeaned</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">])</span>
    <span class="n">cf3</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lonc</span><span class="p">,</span><span class="n">demeaned</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">pr_c</span><span class="p">,</span><span class="n">nc</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> 
                       <span class="n">levels</span><span class="o">=</span><span class="n">ax3_levels</span><span class="p">,</span> <span class="o">**</span><span class="n">cf3_kwargs</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Precipitation Anomaly&#39;</span><span class="p">,</span><span class="n">fontname</span><span class="o">=</span><span class="n">fnt</span><span class="p">)</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="o">*</span><span class="n">width</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span><span class="n">fontname</span><span class="o">=</span><span class="n">fnt</span><span class="p">)</span>

<span class="c1"># clear and reset the axis configurations</span>
<span class="k">def</span> <span class="nf">reset_axes_plot</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;ylabel&#39;</span><span class="p">:</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;ylim&#39;</span><span class="p">:[</span><span class="nb">min</span><span class="p">(</span><span class="n">sin_ticks</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">sin_ticks</span><span class="p">)],</span> 
               <span class="s1">&#39;yticks&#39;</span><span class="p">:</span><span class="n">sin_ticks</span><span class="p">,</span> <span class="s1">&#39;yticklabels&#39;</span><span class="p">:</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">tick_lat</span><span class="p">)})</span>
    
    <span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;ylabel&#39;</span><span class="p">:</span><span class="s1">&#39;global AOD&#39;</span><span class="p">})</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="n">ax3</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plot</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">new</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %matplotlib ipympl</span>
<span class="c1"># if using jupyter notebook rather than jupyer lab, use %matplotlib notebook</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span>

<span class="n">div</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="o">*</span><span class="n">width</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="o">*</span><span class="n">width</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> 
                          <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span><span class="mi">11</span><span class="o">*</span><span class="n">width</span><span class="o">/</span><span class="n">div</span><span class="p">,</span>  <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span><span class="mi">10</span><span class="o">*</span><span class="n">width</span><span class="o">/</span><span class="n">div</span><span class="p">})</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span><span class="c1">#subplots(3,2,figsize=(12,6))#,sharex=True)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">.06</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">.88</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">.9</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">hspace</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span>
                       <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mf">.8</span><span class="p">,</span> <span class="mf">.05</span><span class="p">,</span><span class="mf">1.3</span><span class="p">,</span><span class="mf">.02</span><span class="p">,</span><span class="mf">.07</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">.1</span><span class="p">,</span><span class="mf">.25</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># evolv2k AOD</span>
<span class="n">ax0</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax0c</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax0_cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax0_sm</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">ax0c</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">sharex</span><span class="p">(</span><span class="n">ax0</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

<span class="c1"># LMR</span>
<span class="c1"># temp                     </span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax2c</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">cb2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax2_sm</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">ax2c</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\xb0</span><span class="s2"> C&quot;</span><span class="p">,</span> 
                   <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="n">loc</span> <span class="k">for</span> <span class="n">ik</span><span class="p">,</span> <span class="n">loc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax2_levels</span><span class="p">)</span> <span class="k">if</span> <span class="n">ik</span><span class="o">%</span><span class="k">2</span>&gt;0])
<span class="n">cb2</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>                     
<span class="n">cf2_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">ax2_sm</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span> <span class="s1">&#39;norm&#39;</span> <span class="p">:</span> <span class="n">ax2_sm</span><span class="o">.</span><span class="n">norm</span><span class="p">}</span>

<span class="c1"># precip                     </span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax3c</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>                     
<span class="n">cb3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax3_sm</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">ax3c</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;mm/day&#39;</span><span class="p">)</span>
<span class="n">cb3</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
<span class="n">cf3_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">ax3_sm</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span>
             <span class="s1">&#39;norm&#39;</span><span class="p">:</span><span class="n">ax3_sm</span><span class="o">.</span><span class="n">norm</span><span class="p">}</span>  

<span class="c1"># initial plot</span>
<span class="n">valinit</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">reset_axes_plot</span><span class="p">(</span><span class="n">erup_yrs</span><span class="p">[</span><span class="n">valinit</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fbb0975b1cf6c8c43c85aa94e1770af64677cb71c3cbddda927610f51a2bd7af.png" src="../../_images/fbb0975b1cf6c8c43c85aa94e1770af64677cb71c3cbddda927610f51a2bd7af.png" />
</div>
</div>
</section>
<section id="adding-widget-control-to-the-dashboard">
<h3>Adding widget control to the dashboard<a class="headerlink" href="#adding-widget-control-to-the-dashboard" title="Permalink to this heading">#</a></h3>
<p>Here we initialize two widgets: a dropdown initially populated by the list of <code class="docutils literal notranslate"><span class="pre">erup_yrs</span></code>,  a free text box that allows you to enter a year not included in that list and a container to put them both in.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> ipympl
<span class="c1"># if using jupyter notebook rather than jupyer lab, use %matplotlib notebook</span>

<span class="c1"># dropdown with major volcanic events</span>
<span class="n">dropdown</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="n">erup_yrs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
    <span class="n">options</span><span class="o">=</span><span class="n">erup_yrs</span><span class="p">,</span> 
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Eruption&#39;</span><span class="p">,</span> 
    <span class="n">layout</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># free text field look at a year outside of dropdown options</span>
<span class="n">year_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
                          <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Enter a year (916-1900 CE):&#39;</span><span class="p">,</span> 
                          <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span>  <span class="s1">&#39;initial&#39;</span><span class="p">},</span>
                          <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># box to hold the dropdown widget and free text field</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">dropdown</span><span class="p">,</span> <span class="n">year_input</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
    <span class="n">display</span><span class="o">=</span><span class="s1">&#39;flex&#39;</span><span class="p">,</span> <span class="n">justify_content</span><span class="o">=</span><span class="s1">&#39;space-around&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;70%&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">update_from_dropdown</span></code> updates the plots based on the selection made from the dropdown.</p>
<p><code class="docutils literal notranslate"><span class="pre">update_from_freefield</span></code> updates the plots according to the year typed into the text field, and adds the year (indicated with an astrisk) to the dropdown.  This extra functionality allows you to view a year not included in the original set, and add it to the working set without needing maintain a mental list of which years came from which source.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">update_from_dropdown</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>    
    <span class="n">ax2</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">new</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">yr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">yr</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">new</span>
    
    <span class="n">reset_axes_plot</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">update_from_freefield</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>    
    <span class="n">ax2</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    
    <span class="n">demeaned_d</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">new</span><span class="p">)]</span><span class="o">=</span><span class="n">make_demeaned</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">new</span><span class="p">))</span>
    <span class="n">opts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;*&#39;</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">erup_yrs</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">demeaned_d</span><span class="p">)]</span>
    <span class="n">dropdown</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">opts</span>
    <span class="n">dropdown</span><span class="o">.</span><span class="n">value</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">new</span><span class="p">)</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">new</span><span class="p">)</span> <span class="ow">in</span> <span class="n">erup_yrs</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">new</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;*&#39;</span> 
    
    <span class="n">reset_axes_plot</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">new</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>     
</pre></div>
</div>
</div>
</div>
<p>The cell below pulls all the parts together! The four plots are initialized in roughly the same way they were above (the scalar mappables here cover the full range of values included in the precomputed events, rather than being specific to a particular event as they were previously). The primary new information is the setting up the widgets to <code class="docutils literal notranslate"><span class="pre">observe</span></code> behavior.
For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dropdown</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_from_dropdown</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>sets up the dropdown to pass the selected value to the <code class="docutils literal notranslate"><span class="pre">update_from_dropdown()</span></code> function.</p>
<div class="alert alert-block alert-warning">
<b>Heads up!</b> In order to render the widgets, please open this Jupyter Book in mybinder by clicking the spaceship button in the header.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> ipympl
<span class="c1"># if using jupyter notebook rather than jupyer lab, use %matplotlib notebook</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span>

<span class="n">div</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="o">*</span><span class="n">width</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="o">*</span><span class="n">width</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> 
                          <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span><span class="mi">11</span><span class="o">*</span><span class="n">width</span><span class="o">/</span><span class="n">div</span><span class="p">,</span>  <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span><span class="mi">10</span><span class="o">*</span><span class="n">width</span><span class="o">/</span><span class="n">div</span><span class="p">})</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span><span class="c1">#subplots(3,2,figsize=(12,6))#,sharex=True)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">.06</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">.88</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">.9</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">hspace</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span>
                       <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mf">.8</span><span class="p">,</span> <span class="mf">.05</span><span class="p">,</span><span class="mf">1.3</span><span class="p">,</span><span class="mf">.02</span><span class="p">,</span><span class="mf">.07</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">.1</span><span class="p">,</span><span class="mf">.25</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># evolv2k AOD</span>
<span class="n">ax0</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax0c</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">vol_vlims</span> <span class="o">=</span> <span class="p">[</span><span class="n">vol_ds</span><span class="o">.</span><span class="n">aod550</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vol_ds</span><span class="o">.</span><span class="n">aod550</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">ax0_sm</span> <span class="o">=</span> <span class="n">make_scalar_mappable</span><span class="p">(</span><span class="n">vol_vlims</span><span class="p">,</span> <span class="s1">&#39;magma&#39;</span><span class="p">)</span>
<span class="n">ax0_cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax0_sm</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">ax0c</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">sharex</span><span class="p">(</span><span class="n">ax0</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

<span class="c1"># LMR</span>
<span class="c1"># temp                     </span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax2c</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">ax2_Li_1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">air_lim</span><span class="p">))</span>
<span class="n">ax2_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">ax2_Li_1</span><span class="p">,</span> <span class="n">ax2_Li_1</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2_sm</span> <span class="o">=</span> <span class="n">make_scalar_mappable</span><span class="p">([</span><span class="n">ax2_Li_1</span><span class="p">,</span> <span class="o">-</span><span class="n">ax2_Li_1</span><span class="p">],</span> <span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">cb2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax2_sm</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">ax2c</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\xb0</span><span class="s2"> C&quot;</span><span class="p">,</span> 
                   <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="n">loc</span> <span class="k">for</span> <span class="n">ik</span><span class="p">,</span> <span class="n">loc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax2_levels</span><span class="p">)</span> <span class="k">if</span> <span class="n">ik</span><span class="o">%</span><span class="k">2</span>&gt;0])
<span class="n">cb2</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>                     
<span class="n">cf2_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">ax2_sm</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span> <span class="s1">&#39;norm&#39;</span> <span class="p">:</span> <span class="n">ax2_sm</span><span class="o">.</span><span class="n">norm</span><span class="p">}</span>

<span class="c1"># precip                     </span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax3c</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>                     
<span class="n">ax3_Li_1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">prate_lim</span><span class="p">))</span>
<span class="n">ax3_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">ax3_Li_1</span><span class="p">,</span> <span class="n">ax3_Li_1</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax3_sm</span> <span class="o">=</span> <span class="n">make_scalar_mappable</span><span class="p">([</span><span class="n">ax3_Li_1</span><span class="p">,</span> <span class="o">-</span><span class="n">ax3_Li_1</span><span class="p">],</span> <span class="s1">&#39;BrBG&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">cb3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax3_sm</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">ax3c</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;mm/day&#39;</span><span class="p">)</span>
<span class="n">cb3</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
<span class="n">cf3_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="n">ax3_sm</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span>
             <span class="s1">&#39;norm&#39;</span><span class="p">:</span><span class="n">ax3_sm</span><span class="o">.</span><span class="n">norm</span><span class="p">}</span>  

<span class="c1"># initial plot</span>
<span class="n">valinit</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">reset_axes_plot</span><span class="p">(</span><span class="n">erup_yrs</span><span class="p">[</span><span class="n">valinit</span><span class="p">])</span>

<span class="c1"># initiate observing by widgets</span>
<span class="n">dropdown</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_from_dropdown</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">year_input</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_from_freefield</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># display widgets</span>
<span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">options</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "354188fcb1fe4728a734cffef885024b", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "a03a99bbe8044059b999e69ad1df78c3", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p>And voila! A dashboard that can be explored via a dropdown! Hopefully this notebook showed that a dashboard is mostly a collection of simpler plots, but there are a few adjustments that can help tie axes together and widgets can make exploring a data set more space-efficient.</p>
</section>
<section id="resources-and-references">
<h2>Resources and references<a class="headerlink" href="#resources-and-references" title="Permalink to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p><em>For details, see</em></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Hakim, G. J., Emile-Geay, J., Steig, E. J., Noone, D., Anderson, D. M., Tardif, R., Steiger, N., and Perkins, W. A. (2016), The last millennium climate reanalysis project: Framework and first results, J. Geophys. Res. Atmos., 121, 6745– 6764, doi:10.1002/2016JD024751.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Tardif, R., Hakim, G. J., Perkins, W. A., Horlick, K. A., Erb, M. P., Emile-Geay, J., Anderson, D. M., Steig, E. J., and Noone, D.: Last Millennium Reanalysis with an expanded proxy database and seasonal proxy modeling, Clim. Past, 15, 1251–1273,  https://doi.org/10.5194/cp-15-1251-2019 , 2019.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Neukom, R., L. A. Barboza, M. P. Erb, F. Shi, J. Emile-Geay, M. N. Evans, J. Franke, D. S. Kaufman, L. Lücke, K. Rehfeld, A. Schurer, F. Zhu, S. Br ̈onnimann, G. J. Hakim, B. J. Henley, F. C. Ljungqvist, N. McKay, V. Valler, and L. von Gunten (2019), Consistent multidecadal variability in global temperature reconstructions and simulations over the common era, Nature Geoscience, 12(8), 643–649, doi:10.1038/s41561-019-0400-0.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Kageyama, M., Braconnot, P., Harrison, S. P., Haywood, A. M., Jungclaus, J. H., Otto-Bliesner, B. L., Peterschmitt, J.-Y., Abe-Ouchi, A., Albani, S., Bartlein, P. J., Brierley, C., Crucifix, M., Dolan, A., Fernandez-Donado, L., Fischer, H., Hopcroft, P. O., Ivanovic, R. F., Lambert, F., Lunt, D. J., Mahowald, N. M., Peltier, W. R., Phipps, S. J., Roche, D. M., Schmidt, G. A., Tarasov, L., Valdes, P. J., Zhang, Q., and Zhou, T.: The PMIP4 contribution to CMIP6 – Part 1: Overview and over-arching analysis plan, Geosci. Model Dev., 11, 1033–1057, https://doi.org/10.5194/gmd-11-1033-2018, 2018.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Toohey, M. and Sigl, M.: Volcanic stratospheric sulfur injections and aerosol optical depth from 500 BCE to 1900 CE, Earth Syst. Sci. Data, 9, 809–831, https://doi.org/10.5194/essd-9-809-2017, 2017.</p></td>
</tr>
</tbody>
</table>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-env-paleobook-dev-py"
        },
        kernelOptions: {
            name: "conda-env-paleobook-dev-py",
            path: "./notebooks/science_bits"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-env-paleobook-dev-py'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="CMIP6_LMR.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">PaMoDaCo: CMIP6 vs LMR</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optical-properties-of-volcanic-aerosols">Optical properties of volcanic aerosols</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hovmuller-diagram-pcolor-plot">Hovmüller diagram:<code class="docutils literal notranslate"><span class="pre">pcolor</span></code> plot</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#components">Components</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#global-average-saod550-variation-timeseries">Global average SAOD550 variation timeseries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#weighted-mean">Weighted Mean</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-last-millennium-reanalysis-project-lmr">The Last Millennium Reanalysis Project (LMR)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dashboard">Dashboard</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-exhaustive-list-of-volcanic-events">Non-exhaustive list of volcanic events</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precompute-anomalies">Precompute anomalies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-the-dashboard">Building the dashboard</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-widget-control-to-the-dashboard">Adding widget control to the dashboard</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resources-and-references">Resources and references</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jordan Landers (for a start)
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>